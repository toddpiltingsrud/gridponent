"use strict";var gridponent=gridponent||function(n,t){var i,r,u;if(typeof n=="string"&&(n=document.querySelector(n)),n instanceof HTMLElement)return(i=n.querySelector(".table-container"),i&&i.api)?i.api:(r=new gridponent.Initializer(n),u=r.initializeOptions(t),u.node.api);throw new Error("Could not resolve selector: "+n.toString());};(function(n){n.events={rowSelected:"rowselected",beforeInit:"beforeinit",beforeRead:"beforeread",beforeEdit:"beforeedit",onRead:"onread",onEdit:"onedit",editReady:"editready",httpError:"httpError",ready:"ready"};n.api=function(n){this.controller=n;this.config=n.config;this.$n=$(this.config.node)};n.api.prototype={create:function(n){return this.controller.addRow(n),this},destroy:function(n,t){return this.controller.deleteRow(n,t,!0),this},dispose:function(){return this.controller.dispose(),this},find:function(n){return this.$n.find(n).addBack(n)},getData:function(n){return n!=undefined?this.config.map.get(n):this.controller.config.requestModel.data},getTableRow:function(t){return n.getTableRow(this.controller.config.map,t,this.controller.config.node)},read:function(n,t){return this.controller.read(n,t),this},refresh:function(n){return this.controller.read(null,n),this},saveChanges:function(n,t){return this.controller.updateRow(n,t),this},search:function(t,i){return t=n.isNullOrEmpty(t)?"":t.toString(),this.controller.search(t,i),this},sort:function(t,i,r){return t=n.isNullOrEmpty(t)?"":t.toString(),i=typeof i=="boolean"?i:i==="false"?!1:!!i,this.controller.sort(t,i,r),this},toggleBusy:function(n){return n=n===!0||n===!1?n:!this.$n.hasClass("busy"),n?this.$n.addClass("busy"):this.$n.removeClass("busy"),this}};Object.getOwnPropertyNames(n.events).forEach(function(t){n.api.prototype[t]=function(i){return typeof i=="function"&&this.controller.addDelegate(n.events[t],i),this}});n.api.prototype.ready=function(n){return this.controller.ready(n),this};n.api.prototype.rowSelected=function(t){return typeof t=="function"&&(this.controller.addDelegate(n.events.rowSelected,t),this.$n.addClass("selectable")),this};n.Controller=function(n,t,i,r){this.config=n;this.model=t;this.$n=$(n.node);this.requestModel=i;this.injector=r;this.pollInterval=null;n.pager&&(this.requestModel.top=25);this.handlers={readHandler:this.read.bind(this),commandHandler:this.commandHandler.bind(this),rowSelectHandler:this.rowSelectHandler.bind(this),httpErrorHandler:this.httpErrorHandler.bind(this),toolbarChangeHandler:this.toolbarChangeHandler.bind(this),toolbarEnterKeyHandler:this.toolbarEnterKeyHandler.bind(this),resizeHandler:this.resizeHandler.bind(this)};this.done=!1;this.eventDelegates={};this.addBusyDelegates()};n.Controller.prototype={init:function(){var t=this;this.addCommandHandlers(this.config.node);this.addRowSelectHandler(this.config);this.addRefreshEventHandler(this.config);this.addToolbarChangeHandler();this.addResizeHandler();this.done=!0;this.config.preload?this.read(this.config.requestModel,function(){t.handlePolling(t.config);t.invokeDelegates(n.events.ready,t.config.node.api)}):(t.handlePolling(t.config),this.invokeDelegates(n.events.ready,this.config.node.api))},addResizeHandler:function(){(this.config.fixedheaders||this.config.fixedfooters)&&window.addEventListener("resize",this.handlers.resizeHandler)},removeResizeHandler:function(){(this.config.fixedheaders||this.config.fixedfooters)&&window.removeEventListener("resize",this.handlers.resizeHandler)},resizeHandler:function(){var n=this.injector.exec("columnWidthStyle");this.$n.find("style.column-width-style").html(n)},addBusyDelegates:function(){this.addDelegate(n.events.beforeRead,this.addBusy);this.addDelegate(n.events.onRead,this.removeBusy);this.addDelegate(n.events.beforeEdit,this.addBusy);this.addDelegate(n.events.onEdit,this.removeBusy);this.addDelegate(n.events.httpError,this.removeBusy)},addBusy:function(){this.$n.addClass("busy")},removeBusy:function(){this.$n.removeClass("busy")},ready:function(t){this.done?n.applyFunc(t,this.config.node.api,this.config.node.api):this.addDelegate(n.events.ready,t)},addDelegate:function(n,t){this.eventDelegates[n]=this.eventDelegates[n]||[];this.eventDelegates[n].push(t)},invokeDelegates:function(t,i){var f=this,r=!0,u=this.eventDelegates[t];return Array.isArray(u)&&u.forEach(function(t){r!==!1&&(r=n.applyFunc(t,f.config.node.api,i))}),r},addToolbarChangeHandler:function(){var n=".table-toolbar [name], thead input, .table-pager input";this.$n.on("change",n,this.handlers.toolbarChangeHandler);this.$n.on("keydown",n,this.handlers.toolbarEnterKeyHandler)},removeToolbarChangeHandler:function(){this.$n.off("change",this.handlers.toolbarChangeHandler);this.$n.off("keydown",this.handlers.toolbarEnterKeyHandler)},toolbarEnterKeyHandler:function(n){if(n.keyCode==13){n.target.blur();return}},toolbarChangeHandler:function(t){var i=t.target.name,r=this.config.requestModel,u=n.getType(r[i]),f=n.ModelSync.cast(t.target.value,u);r[i]=f;this.read()},addCommandHandlers:function(n){$(n).on("click","button[value],a[value]",this.handlers.commandHandler)},removeCommandHandlers:function(n){$(n).off("click",this.handlers.commandHandler)},commandHandler:function(t){var h,u=$(t.currentTarget),f=u.closest("tr[data-uid],div.modal",this.config.node),e=f.length?this.config.map.get(f[0]):null,o=u.attr("value"),r=n.getCommand(this.config.columns,o),i=this.config.requestModel,c,s;if(r&&typeof r.func=="function"){r.func.call(this.config.node.api,e);return}h=(o||"").toLowerCase();switch(h){case"addrow":this.addRow();break;case"edit":this.editRow(e,f);break;case"delete":case"destroy":this.deleteRow(e,f);break;case"page":c=u.attr("data-page");i.page=parseInt(c);this.read();break;case"search":i.search=this.$n.find(".table-toolbar input[name=search]").val();this.read();break;case"sort":s=u.attr("data-sort");i.sort===s?i.desc=!i.desc:(i.sort=s,i.desc=!1);this.read();break;default:r=n.getObjectAtPath(o);typeof r=="function"&&r.call(this.config.node.api,e)}},getEditor:function(t){var r=this,i;return i=t==undefined?new n.Editor(this.config,this.model,this.injector):t=="modal"?new n.ModalEditor(this.config,this.model,this.injector):new n.TableRowEditor(this.config,this.model,this.injector),i.beforeEdit=function(t){r.invokeDelegates(n.events.beforeEdit,t)},i.afterEdit=function(t){r.invokeDelegates(n.events.onEdit,t)},i.editReady=function(t){r.invokeDelegates(n.events.editReady,t)},i},addRowSelectHandler:function(){this.$n.on("click","div.table-body > table > tbody > tr:not(.update-mode,.create-mode) > td.body-cell",this.handlers.rowSelectHandler)},removeRowSelectHandler:function(){this.$n.off("click",this.handlers.rowSelectHandler)},rowSelectHandler:function(t){var i=this.config,f=$(t.target).closest("tr",i.node),o=this.$n.find("div.table-body > table > tbody > tr.selected"),r=typeof i.rowselected,u,e;$(t.target).closest("a,:input,:button,:submit",i.node).length>0||(r==="string"&&i.rowselected.indexOf("{{")!==-1&&(r="urlTemplate"),o.removeClass("selected"),$(f).addClass("selected"),u=i.map.get(f),e=this.invokeDelegates(n.events.rowSelected,u),e!==!1)&&r==="urlTemplate"&&(window.location=n.supplant.call(this.config.node.api,i.rowselected,u))},addRefreshEventHandler:function(n){if(n.refreshevent)$(document).on(n.refreshevent,this.handlers.readHandler)},removeRefreshEventHandler:function(n){n.refreshevent&&$(document).off(n.refreshevent,this.handlers.readHandler)},search:function(n,t){this.config.requestModel.search=n;this.$n.find("div.table-toolbar input[name=search]").val(n);this.read(null,t)},sort:function(n,t,i){this.config.requestModel.sort=n;this.config.requestModel.desc=t==!0;this.read(null,i)},read:function(t,i){var r=this,u=!0;(t&&n.shallowCopy(t,this.config.requestModel),u=this.invokeDelegates(n.events.beforeRead,this.config.node.api),u!==!1)&&this.model.read(this.config.requestModel,function(t){try{n.shallowCopy(t,r.config.requestModel,!0);r.injector.setResource("$data",r.config.requestModel.data);r.config.map.clear();n.resolveTypes(r.config);r.refresh(r.config);r.invokeDelegates(n.events.onRead,r.config.node.api);n.applyFunc(i,r.config.node,r.config.requestModel)}catch(u){r.removeBusy();r.httpErrorHandler(u)}},this.handlers.httpErrorHandler)},handlePolling:function(n){if($.isNumeric(n.poll)&&!(n.poll<=0)){var t=this;this.pollInterval=setInterval(function(){var i=n.node.ownerDocument.body.contains(n.node);i?t.read(n.requestModel):(clearInterval(t.pollInterval),t.pollInterval=null)},n.poll*1e3)}},addRow:function(n){var t=this.getEditor(this.config.editmode),i=t.add(n);return t},editRow:function(n,t){var i=this.getEditor(this.config.editmode),r=i.edit(n,t);return i},updateRow:function(t,i){try{var r=this,u=this.getEditor(),f;if(!n.hasValue(this.config.update)){n.applyFunc(i,r.config.node);return}u.edit(t);u.save(function(u){f=n.getTableRow(r.config.map,t,r.$n[0]);f&&r.refresh();typeof i=="function"&&n.applyFunc(i,r,u)},this.httpErrorHandler.bind(this))}catch(e){this.removeBusy();this.httpErrorHandler(e)}},deleteRow:function(t,i,r){try{if(!n.hasValue(this.config.destroy)){n.applyFunc(i,this.config.node);return}var u=this,e=r||confirm("Are you sure you want to delete this item?"),f=n.getTableRow(this.config.map,t,this.$n[0]);if(!e){n.applyFunc(i,this.config.node);return}this.invokeDelegates(n.events.beforeEdit,{type:"destroy",dataItem:t,elem:f});this.model.destroy(t,function(r){try{if(!r||!r.errors){var e=u.config.requestModel.data.indexOf(t);e!=-1&&u.config.requestModel.data.splice(e,1);u.refresh(u.config)}}catch(o){n.error(o)}u.invokeDelegates(n.events.onEdit,{type:"destroy",dataItem:t,elem:f});n.applyFunc(i,u.config.node.api,r)},u.handlers.httpErrorHandler)}catch(o){this.removeBusy();this.httpErrorHandler(o)}},refresh:function(){try{var t=this.$n.find("div.table-body"),i=this.$n.find("div.table-footer"),r=this.$n.find("div.table-pager"),u=this.$n.find("style.sort-style");this.config.map.clear();t.html(this.injector.exec("tableBody"));i.html(this.injector.exec("footerTable"));r.html(this.injector.exec("pagerBar"));u.html(this.injector.exec("sortStyle"))}catch(f){n.error(f)}},httpErrorHandler:function(t){this.invokeDelegates(n.events.httpError,t);alert("An error occurred while carrying out your request.");n.error(t)},dispose:function(){this.removeRefreshEventHandler(this.config);this.removeRowSelectHandler();this.removeCommandHandlers(this.config.node);this.removeToolbarChangeHandler();this.removeResizeHandler();this.pollInterval&&clearInterval(this.pollInterval)}};n.DataLayer=function(n){this.config=n;this.reader=null};n.DataLayer.prototype={getReader:function(){var i=n.getType(this.config.read),t;switch(i){case"string":return new n.ServerPager(this.config.read);case"function":return new n.FunctionPager(this.config);case"object":if(n["implements"](this.config.read,n.RequestModel.prototype))return t=new n.RequestModel,n.shallowCopy(this.config.read,t,!0),this.config.requestModel=t,new n.ClientPager(this.config);throw"Unsupported read configuration";case"array":return this.config.requestModel.data=this.config.read,new n.ClientPager(this.config);default:throw"Unsupported read configuration";}},read:function(t,i,r){var u=this;this.reader||(this.reader=this.getReader());this.reader.read(t,function(t){t=u.resolveResult(t);n.applyFunc(i,u,[t])},function(t){n.applyFunc(r,u,[t])})},create:function(t,i,r){var u=this,f,e;typeof this.config.create=="function"?n.applyFunc(this.config.create,this.config.node.api,[t,i,r],r):(f=n.supplant(this.config.create,t),e=new n.Http,e.post(f,t,function(t){n.applyFunc(i,u,t)},function(t){n.applyFunc(r,u,t)}))},update:function(t,i,r){var u=this,f,e;typeof this.config.update=="function"?n.applyFunc(this.config.update,this.config.node.api,[t,i,r],r):(f=n.supplant(this.config.update,t),e=new n.Http,e.post(f,t,function(t){n.applyFunc(i,u,t)},function(t){n.applyFunc(r,u,t)}))},destroy:function(t,i,r){var u=this,f,e;typeof this.config.destroy=="function"?n.applyFunc(this.config.destroy,this.config.node.api,[t,i,r],r):(f=n.supplant(this.config.destroy,t),e=new n.Http,e.destroy(f,function(t){n.applyFunc(i,u,t)},function(t){n.applyFunc(r,u,t)}))},resolveResult:function(t){return n.hasValue(t)&&Array.isArray(t)?new n.RequestModel(t):t}};n.DataMap=function(){this.uid=0;this.map={}};n.DataMap.prototype={assign:function(n){var t=++this.uid;return this.map[t]=n,t},get:function(n){var t=this.resolveUid(n);return this.map[t]},getUid:function(n){for(var t,r=Object.getOwnPropertyNames(this.map),i=0;i<r.length;i++)if(t=r[i],this.map[t]===n)return t;return-1},resolveUid:function(n){var t=-1;return($.isNumeric(n)?t=parseInt(n):(n=$(n).closest("[data-uid]"),n.length===1&&(t=parseInt($(n).attr("data-uid")))),isNaN(t))?-1:t},remove:function(n){var t=this.resolveUid(n);t in this.map&&delete this.map[t]},clear:function(){this.uid=0;this.map={}}};n.Editor=function(n,t,i){this.config=n;this.dal=t;this.uid=null;this.dataItem=null;this.originalDataItem=null;this.mode=null;this.beforeEdit=null;this.afterEdit=null;this.editReady=null;this.button=null;this.$n=$(n.node);this.injector=i};n.Editor.prototype={add:function(n){return this.dataItem=n||this.createDataItem(),this.mode="create",this.injector.setResource("$dataItem",this.dataItem).setResource("$mode",this.mode),this.config.requestModel.data.push(this.dataItem),this.uid=this.config.map.assign(this.dataItem),{dataItem:this.dataItem,uid:this.uid}},edit:function(t){return this.dataItem=t,this.mode="update",this.setInjectorContext(),this.originalDataItem=n.shallowCopy(t),{dataItem:t}},cancel:function(){if(this.setInjectorContext(),this.mode==="create"){this.config.map.remove(this.uid);var t=this.config.requestModel.data.indexOf(this.dataItem);t!==-1&&this.config.requestModel.data.slice(t,1)}else this.mode=="update"&&this.originalDataItem&&n.shallowCopy(this.originalDataItem,this.dataItem);this.removeCommandHandler()},httpErrorHandler:function(t){alert("An error occurred while carrying out your request.");n.error(t)},save:function(t,i){var r=this,u,i=i||n.error;this.setInjectorContext();this.addBusy();this.elem&&(u=n.ModelSync.serialize(this.elem),n.ModelSync.castValues(u,this.config.columns),n.shallowCopy(u,this.dataItem));typeof this.beforeEdit=="function"&&this.beforeEdit({type:this.mode,dataItem:this.dataItem,elem:this.elem});this.mode=="create"?this.dal.create(this.dataItem,function(n){r.handleResponse(n,t,i)},function(t){r.removeBusy();n.applyFunc(i,r,t)}):this.dal.update(this.dataItem,function(n){r.handleResponse(n,t,i)},function(t){r.removeBusy();n.applyFunc(i,r,t)})},handleResponse:function(t,i,r){var u,f;try{this.injector.setResource("$mode",null);u=n.resolveResponseModel(t,this.dataItem);n.hasValue(u.errors)?this.validate(u):(n.shallowCopy(u.dataItem,this.dataItem),this.elem&&(this.updateUI(this.config,this.dataItem,this.elem),this.removeCommandHandler&&this.removeCommandHandler()))}catch(e){f=r||n.error;f(e)}this.button instanceof HTMLElement&&n.enable(this.button);this.removeBusy();typeof this.afterEdit=="function"&&this.afterEdit({type:this.mode,dataItem:this.dataItem,elem:this.elem});n.applyFunc(i,this.config.node.api,u)},addBusy:function(){this.$n.addClass("busy")},removeBusy:function(){this.$n.removeClass("busy")},updateUI:function(){},validate:function(){},createDataItem:function(){var t,i={};return this.config.columns.forEach(function(r){t=r.field||r.sort;n.hasValue(t)&&(i[t]=n.hasValue(r.Type)?n.getDefaultValue(r.Type):"")}),typeof this.config.model=="object"&&n.shallowCopy(this.config.model,i),i},setInjectorContext:function(){this.injector.setResource("$dataItem",this.dataItem).setResource("$mode",this.mode)}};n.TableRowEditor=function(t,i,r){var u=this;n.Editor.call(this,t,i,r);this.elem=null;this.commandHandler=function(t){var i=$(this).val();/^(create|update|save)$/i.test(i)?(u.button=t.target,n.disable(u.button,5),u.save(null,u.httpErrorHandler)):/^cancel$/i.test(i)&&u.cancel()}};n.TableRowEditor.prototype=Object.create(n.Editor.prototype);$.extend(n.TableRowEditor.prototype,{addCommandHandler:function(){$(this.elem).on("click","button[value]",this.commandHandler)},removeCommandHandler:function(){$(this.elem).off("click",this.commandHandler)},add:function(t){var i=this.$n.find("div.table-body > table > tbody"),r=n.Editor.prototype.add.call(this,t);return this.elem=$(this.injector.exec("tableRow",r.uid)),n.ModelSync.bindElements(this.dataItem,this.elem),this.addCommandHandler(),this.config.newrowposition==="top"?i.prepend(this.elem):i.append(this.elem),typeof this.elem[0].scrollIntoView=="function"&&this.elem[0].scrollIntoView(),this.invokeEditReady(),this.injector.setResource("$mode",null),{dataItem:this.dataItem,elem:this.elem}},edit:function(t,i){var r;return n.Editor.prototype.edit.call(this,t),this.elem=i,this.addCommandHandler(),r=this.injector.exec("tableRowCells"),$(i).addClass("update-mode").empty().append(r),n.ModelSync.bindElements(t,this.elem),this.invokeEditReady(),this.injector.setResource("$mode",null),{dataItem:t,elem:this.elem}},cancel:function(){n.Editor.prototype.cancel.call(this);try{var i=$(this.elem).closest("table",this.$n);$(this.elem).hasClass("create-mode")?$(this.elem).remove():this.updateUI()}catch(t){n.error(t)}},validate:function(t){if(typeof this.config.validate=="function")n.applyFunc(this.config.validate,this,[this.elem,t]);else{var r=this,i=new n.StringBuilder,u;i.add("Please correct the following errors:\r\n");$(r.elem).find("[name].error").removeClass("error");Object.getOwnPropertyNames(t.errors).forEach(function(n){$(r.elem).find('[name="'+n+'"]').addClass("error");u=t.errors[n].errors;i.add(n+":\r\n").add(u.map(function(n){return"    - "+n+"\r\n"}).join(""))});alert(i.toString())}},updateUI:function(){var n;this.injector.setResource("$mode","read");n=this.injector.exec("tableRowCells");$(this.elem).removeClass("update-mode create-mode").empty().append(n)},invokeEditReady:function(){typeof this.editReady=="function"&&this.editReady({dataItem:this.dataItem,elem:this.elem})}});n.ModalEditor=function(t,i,r){n.TableRowEditor.call(this,t,i,r)};n.ModalEditor.prototype=Object.create(n.Editor.prototype);$.extend(n.ModalEditor.prototype,{addCommandHandler:n.TableRowEditor.prototype.addCommandHandler,removeCommandHandler:n.TableRowEditor.prototype.removeCommandHandler,validate:n.TableRowEditor.prototype.validate,invokeEditReady:n.TableRowEditor.prototype.invokeEditReady,add:function(t){var r=this,u,i;n.Editor.prototype.add.call(this,t);u=this.injector.exec("bootstrapModal");i=$(u).appendTo(this.config.node).one("shown.bs.modal",function(){r.addCommandHandler();r.invokeEditReady()});this.elem=i[0];i.modal({show:!0,keyboard:!0,backdrop:"static"});n.ModelSync.bindElements(this.dataItem,this.elem);i.one("hidden.bs.modal",function(){$(i).remove()});return{dataItem:this.dataItem,elem:this.elem}},edit:function(t){var r=this,u,i;n.Editor.prototype.edit.call(this,t);u=this.injector.exec("bootstrapModal");i=$(u).appendTo(this.config.node).one("shown.bs.modal",r.invokeEditReady.bind(r));this.elem=i[0];i.modal({show:!0,keyboard:!0,backdrop:"static"});n.ModelSync.bindElements(t,this.elem);i.one("hidden.bs.modal",function(){$(i).remove()});return this.addCommandHandler(),{dataItem:t,elem:this.elem}},cancel:function(){n.Editor.prototype.cancel.call(this);$(this.elem).modal("hide")},updateUI:function(){var i,r,t,u,f;$(this.elem).modal("hide");t=this.injector.exec("tableRow",this.uid);this.mode=="create"?(i=this.$n.find("div.table-body > table > tbody"),this.config.newrowposition==="top"?i.prepend(t):i.append(t)):(r=n.getTableRow(this.config.map,this.dataItem,this.config.node),u=r.find("td.body-cell"),f=$(t).find("td.body-cell"),u.each(function(n){$(this).empty().append(f[n])}))}});n.Http=function(){};n.Http.prototype={get:function(n,t,i,r){$.get(n,t).done(i).fail(r)},post:function(n,t,i,r){this.ajax(n,t,i,r,"POST")},destroy:function(n,t,i){this.ajax(n,null,t,i,"DELETE")},ajax:function(n,t,i,r,u){$.ajax({url:n,type:u.toUpperCase(),data:t,contentType:"application/x-www-form-urlencoded; charset=UTF-8"}).done(i).fail(function(n){if(n.status){if(n.status==200){i(n);return}/401|403|407/.test(n.status)==!1&&typeof r=="function"&&r(n)}})}};n.Initializer=function(n){this.parent=$(n)};n.Initializer.prototype={initialize:function(n){return this.config=this.getConfig(this.parent),this.initializeOptions(this.config,n)},initializeOptions:function(t){var i=this,u,r;return t.requestModel={},t.ID=n.createUID(),this.config=t,this.config.map=new n.DataMap,this.config.requestModel=n["implements"](this.config.read,n.RequestModel.prototype)?this.config.read:new n.RequestModel,this.config.editmode=this.config.editmode||"inline",this.config.newrowposition=this.config.newrowposition||"top",this.injector=new n.Injector({$config:this.config,$columns:this.config.columns,$node:this.config.node,$requestModel:this.config.requestModel,$map:this.config.map,$data:this.config.requestModel.data,$mode:"read"},n.templates,null,this.config),this.resolveCustomResource(this.config,this.injector),this.renderLayout(this.config,this.parent),this.config.node=this.parent.find(".table-container")[0],this.$n=this.parent.find(".table-container"),u=new n.DataLayer(this.config),r=new n.Controller(this.config,u,this.config.requestModel,this.injector),this.config.node.api=new n.api(r),this.config.hasFooter=this.resolveFooter(this.config),this.config.preload=this.config.preload===!1?this.config.preload:!0,this.injector.context=this.config.node.api,setTimeout(function(){i.resolveTopLevelOptions(i.config);i.syncToolbar(i.config);i.addEventDelegates(i.config,r);r.invokeDelegates(n.events.beforeInit,i.config);n.resolveTypes(i.config);i.resolveCommands(i.config);r.init()}),this.config},getConfig:function(t){var f=this,r,u,i=n.getAttributes(t),e=$(t).find("gp-column");return i.columns=[],u="header body edit footer".split(" "),e.each(function(){r=n.getAttributes(this);i.columns.push(r);f.resolveTemplates(u,r,this,"template")}),this.resolveTemplates(Object.getOwnPropertyNames(n.templates),i,t,""),i},addEventDelegates:function(t,i){var f=this,u,r,e=t.node.api;Object.getOwnPropertyNames(n.events).forEach(function(f){u=n.events[f];r=t[u];typeof r=="string"&&(r=n.getObjectAtPath(r));typeof r=="function"&&(t[u]=r,i.addDelegate(u,r))})},renderLayout:function(t,i){try{$(i).html(this.injector.exec("container"))}catch(r){n.error(r)}},syncToolbar:function(t){var i,r;try{i=t.node.api.find("div.table-toolbar");n["implements"](t.read,n.RequestModel.prototype)?n.ModelSync.bindElements(t.read,i):(r=n.ModelSync.serialize(i),n.ModelSync.castModel(r,n.RequestModel.prototype),n.shallowCopy(r,t.requestModel))}catch(u){n.error(u)}},resolveFooter:function(n){for(var t=0;t<n.columns.length;t++)if(n.columns[t].footertemplate)return!0;return!1},resolveTopLevelOptions:function(t){var i,r="rowselected searchfunction read create update destroy validate model".split(" ");r.forEach(function(r){n.hasValue(t[r])&&(i=n.getObjectAtPath(t[r]),n.hasValue(i)&&(t[r]=i))})},resolveTemplates:function(t,i,r,u){var o,f,s,e=$(r),h='script[type="text/html"][data-template~="{{name}}"],template[data-template~="{{name}}"]';t.forEach(function(t){if(o=n.supplant(h,{name:t}),f=e.find(o),f.length)for(var r=0;r<e[0].children.length;r++)if(e[0].children[r]==f[0]){s=t+u;i[s]=f[0].innerHTML;return}})},resolveCommands:function(t){var i,r;t.columns.forEach(function(t){typeof t.commands=="string"&&(r=[],t.commands.split(",").forEach(function(n){i=n.split(":");r.push({text:i[0],value:i[1],btnClass:i[2],glyphicon:i[3]})}),t.commands=r);Array.isArray(t.commands)&&t.commands.forEach(function(t){t.text=t.text||t.value;t.value=t.value||t.text;t.btnClass=t.btnClass||(/delete|destroy/i.test(t.text)?"btn-danger":"btn-default");t.glyphicon=t.glyphicon||(/delete|destroy/i.test(t.text)?"glyphicon-remove":/edit/i.test(t.text)?"glyphicon-edit":"glyphicon-cog");t.func=t.func||n.getObjectAtPath(t.value)})})},resolveCustomResource:function(t,i){if(t.inject&&typeof t.inject=="string"){var r=t.inject.match(n.rexp.splitPath);i.setResource(r[r.length-1],n.getObjectAtPath(t.inject))}}};n.Injector=function(n,t,i,r){this.resources=n;n.$injector=this;n.$window=window;this.root=t||window;this.context=i||this;this.overrides=r||{}};n.Injector.prototype={setResource:function(n,t){return this.resources[n]=t,this},base:function(n,t){return this.exec(n,t,!0)},exec:function(t,i,r){var u;return typeof t=="string"&&(t=r?this.root[t]:this.overrides[t]||this.root[t]),typeof t=="function"?(u=this.inject(t),n.hasValue(i)&&u.push(i),t.apply(this.context,u)):n.supplant.call(this.context,t,this.resources,this.resources)},inject:function(n){var t=this,i,r=[];return i=n.$inject?n.$inject:this.getParamNames(n),i.forEach(function(n){if(t.resources.hasOwnProperty(n))r.push(t.resources[n]);else if(n[0]==="$")throw"Unrecognized dependency: "+n;}),r},getParamNames:function(n){var t=n.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,""),i=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g);return i===null&&(i=[]),i}};n.ModelSync={rexp:{rTrue:/^true$/i,rFalse:/^false$/i},serialize:function(n){var i=$(n).find(":input[name]"),r,t={};return i.each(function(){t[this.name]=null}),r=$(i).serializeArray(),r.forEach(function(n){t[n.name]===null||Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]);Array.isArray(t[n.name])?t[n.name].push(n.value):t[n.name]=n.value}),t},bindElements:function(n,t){var r=this,i;Object.getOwnPropertyNames(n).forEach(function(u){i=n[u];Array.isArray(i)?i.forEach(function(n){r.bindElement(u,n,t)}):r.bindElement(u,i,t)})},bindElement:function(t,i,r){var e=this,o,u,f;if(i=n.hasValue(i)?i.toString():"",u=$(r).find('[type=checkbox][name="'+t+'"],[type=radio][name="'+t+'"]'),u.length>0)for(o=n.escapeHTML(i),f=0;f<u.length;f++)if(u[f].value==i||u[f].value==o){u[f].checked=!0;return}if(/^(true|false)$/i.test(i)&&(u=$(r).find('[type=checkbox][name="'+t+'"][value=true],[type=checkbox][name="'+t+'"][value=false]'),u.length>0)){u.each(function(n){this.checked=e.rexp.rTrue.test(i)&&e.rexp.rTrue.test(n.value)||e.rexp.rFalse.test(i)&&e.rexp.rFalse.test(n.value)});return}u=$(r).find('[name="'+t+'"]');u.length>0&&(u[0].value!==undefined?u.val(i):u[0].innerHTML!==undefined&&u.html(i==null?"":n.escapeHTML(i)))},castValues:function(t,i){var r;Object.getOwnPropertyNames(t).forEach(function(u){r=n.getColumnByField(i,u);r&&r.Type&&(t[u]=this.cast(t[u],r.Type))}.bind(this))},castModel:function(t,i){var r,u,f=this,e=Object.getOwnPropertyNames(t);e.forEach(function(e){i.hasOwnProperty(e)&&(r=n.getType(i[e]),r&&(u=t[e],t[e]=f.cast(u,r)))})},cast:function(n,t){switch(t){case"number":if($.isNumeric(n))return parseFloat(n);break;case"boolean":return n!=null&&n.toLowerCase()=="true";case null:case undefined:return/true|false/i.test(n)?n!=null&&n.toLowerCase()=="true":n===""?null:n;default:return n===""?null:n}}};n.ServerPager=function(n){this.url=n};n.ServerPager.prototype={read:function(t,i,r){var u=n.shallowCopy(t),o=Object.getOwnPropertyNames(u).forEach(function(n){/^(page|top|sort|desc|search)$/i.test(n)==!1&&delete u[n]}),f=n.supplant(this.url,t,t),e=new n.Http;e.get(f,u,i,r)}};n.ClientPager=function(t){var i,r=this;this.data=t.requestModel.data;this.columns=t.columns.filter(function(n){return n.field!==undefined||n.sort!==undefined});this.searchFilter=typeof t.searchfunction=="function"?t.searchfunction:function(t,u){for(var e=u.toLowerCase(),f=0;f<r.columns.length;f++)if(i=n.getFormattedValue(t,r.columns[f],!1),n.hasValue(i)&&i.toString().toLowerCase().indexOf(e)!==-1)return!0;return!1}};n.ClientPager.prototype={read:function(t,i){var u,f,e,r,o;try{u=this;e=this.getSkip(t);t.data=this.data.slice(0,this.data.length);n.isNullOrEmpty(t.search)||(f=$.trim(t.search.toString()),t.data=t.data.filter(function(n){return u.searchFilter(n,f)}));t.total=t.data.length;t.pagecount=this.getPageCount(t);n.isNullOrEmpty(t.sort)===!1&&(r=n.getColumnByField(this.columns,t.sort),n.hasValue(r)&&(o=this.getSortFunction(r,t.desc),t.data.sort(function(n,i){return o(n[t.sort],i[t.sort])})));t.top!==-1&&(t.data=t.data.slice(e).slice(0,t.top))}catch(s){n.error(s)}i(t)},getSkip:function(n){var t=n;if(t.pagecount==0)return 0;if(t.page<1)t.page=1;else if(t.page>t.pagecount)return t.page=t.pagecount;return(t.page-1)*t.top},getPageCount:function(n){return n.top>0?Math.ceil(n.total/n.top):n.total===0?0:1},getSortFunction:function(n,t){return/^(number|date|boolean)$/.test(n.Type)?t?this.diffSortDesc:this.diffSortAsc:t?this.stringSortDesc:this.stringSortAsc},diffSortDesc:function(n,t){return t-n},diffSortAsc:function(n,t){return n-t},stringSortDesc:function(t,i){return n.hasValue(t)===!1?n.hasValue(i)?1:0:n.hasValue(i)===!1?-1:t.toString().toLowerCase()>i.toString().toLowerCase()?-1:t.toString().toLowerCase()<i.toString().toLowerCase()?1:0},stringSortAsc:function(t,i){return n.hasValue(t)===!1?n.hasValue(i)?-1:0:n.hasValue(i)===!1?1:t.toString().toLowerCase()>i.toString().toLowerCase()?1:t.toString().toLowerCase()<i.toString().toLowerCase()?-1:0}};n.FunctionPager=function(n){this.config=n};n.FunctionPager.prototype={read:function(t,i,r){try{var e=this,u=this.config.read(t,i.bind(this));n.hasValue(u)&&i(u)}catch(f){typeof r=="function"?n.applyFunc(r,this,f):n.applyFunc(i,this,this.config);n.error(f)}}};n.RequestModel=function(n){var t=this;this.top=-1;this.page=1;this.sort="";this.desc=!1;this.search="";this.data=n||[];this.total=n!=undefined&&n.length?n.length:0;Object.defineProperty(t,"pageindex",{get:function(){return t.page-1}});Object.defineProperty(t,"skip",{get:function(){if(t.top!==-1){if(t.pagecount===0)return 0;if(t.page<1)t.page=1;else if(t.page>t.pagecount)return t.page=t.pagecount;return t.pageindex*t.top}return 0}});Object.defineProperty(t,"pagecount",{get:function(){return t.top>0?Math.ceil(t.total/t.top):t.total===0?0:1}})};n.RequestModel.prototype={top:-1,page:1,sort:"",desc:!1,search:"",data:[],total:0};n.ResponseModel=function(n,t){this.dataItem=n;this.errors=t};n.StringBuilder=function(){this.out=[]};n.StringBuilder.prototype={add:function(n){return this.out.push(n),this},addFormat:function(t,i){return Array.isArray(i)||(i=[i]),this.out.push(n.supplant(t,i)),this},escape:function(t){return this.out.push(n.escapeHTML(t)),this},toString:function(){return this.out.join("")}};n.templates=n.templates||{};n.templates.bodyCellContent=function(t,i,r){var o=this,f,e=(t.Type||"").toLowerCase(),u=new n.StringBuilder;if(i!=null)return f=n.getFormattedValue(i,t,!0),t.bodytemplate?typeof t.bodytemplate=="function"?u.add(n.applyFunc(t.bodytemplate,this,[i,t])):u.add(n.supplant.call(this,t.bodytemplate,i,[i,t])):t.commands&&t.commands.length?(u.add('<div class="btn-group btn-group-xs" role="group">'),t.commands.forEach(function(n){u.add(r.exec("button",n))}),u.add("<\/div>")):n.hasValue(f)&&(e==="boolean"?f===!0&&u.add('<span class="glyphicon glyphicon-ok"><\/span>'):u.add(f)),u.toString()};n.templates.bodyCellContent.$inject=["$column","$dataItem","$injector"];n.templates.bootstrapModal=function(t,i,r,u){var e=u=="create"?"Add":"Edit",o=t.map.getUid(i),f=new n.StringBuilder;return f.add('<div class="modal fade" tabindex="-1" role="dialog" data-uid="'+o+'">').add('<div class="modal-dialog" role="document">').add('<div class="modal-content">').add('<div class="modal-header">').add('<button type="button" class="close" aria-label="Close" value="cancel"><span aria-hidden="true">&times;<\/span><\/button>').add('<h4 class="modal-title">{{title}}<\/h4>').add(e).add("<\/div>").add('<div class="modal-body">').add(r.exec("bootstrapModalBody")).add("<\/div>").add('<div class="modal-footer">').add(r.exec("bootstrapModalFooter")).add("<\/div>").add("<\/div>").add('<div class="gp-progress-overlay">').add('<div class="gp-progress gp-progress-container">').add('<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><\/div>').add("<\/div>").add("<\/div>").add("<\/div>").add("<\/div>"),f.toString()};n.templates.bootstrapModal.$inject=["$config","$dataItem","$injector","$mode"];n.templates.bootstrapModalBody=function(t,i){var u=this,r=new n.StringBuilder;return r.add('<div class="form-horizontal">'),t.columns.forEach(function(t){var e,f;(i.setResource("$column",t),e=!t.readonly&&(n.hasValue(t.field)||n.hasValue(t.edittemplate)),e)&&(f={label:null,input:i.exec("editCellContent"),editclass:t.editclass},f.label=t.headertemplate?typeof t.headertemplate=="function"?n.applyFunc(t.headertemplate,u,[t]):n.supplant.call(u,t.headertemplate,[t]):n.escapeHTML(n.coalesce([t.header,t.field,""])),r.add(i.exec("formGroup",f)))}),r.add("<\/div>"),r.toString()};n.templates.bootstrapModalBody.$inject=["$config","$injector"];n.templates.bootstrapModalFooter=function(n,t){var i=n.filter(function(n){return n.commands});return i.length?(t.setResource("$column",i[0]),t.exec("editCellContent")):'<div class="btn-group"><button type="button" class="btn btn-default" value="cancel"><span class="glyphicon glyphicon-remove"><\/span>Close<\/button><button type="button" class="btn btn-primary" value="save"><span class="glyphicon glyphicon-save"><\/span>Save changes<\/button><\/div>'};n.templates.bootstrapModalFooter.$inject=["$columns","$injector"];n.templates.button=function(t){return n.supplant.call(this,'<button type="button" class="btn {{btnClass}}" value="{{value}}"><span class="glyphicon {{glyphicon}}"><\/span>{{text}}<\/button>',t)};n.templates.columnWidthStyle=function(t,i){var u=new n.StringBuilder,r=0,f=document.querySelectorAll("#"+t.ID+" .table-body > table > tbody > tr:first-child > td"),e,o="#{{0}} .table-header th.header-cell:nth-child({{1}}),#{{0}} .table-footer td.footer-cell:nth-child({{1}}),#{{0}} > .table-body > table > thead th:nth-child({{1}}),#{{0}} > .table-body > table > tbody td:nth-child({{1}}){ width:{{2}}{{3}}; }",s="#{{0}} .table-header th.header-cell:nth-child({{1}}),#{{0}} .table-footer td.footer-cell:nth-child({{1}}){ width:{{2}}px; }";return i.forEach(function(n){n.width?(e=isNaN(n.width)==!1?"px":"",u.addFormat(o,[t.ID,r+1,n.width,e])):f.length&&(t.fixedheaders||t.fixedfooters)&&u.addFormat(s,[t.ID,r+1,f[r].offsetWidth]);r++}),u.toString()};n.templates.columnWidthStyle.$inject=["$config","$columns"];n.templates.container=function(t,i){var r=new n.StringBuilder;return r.addFormat('<div class="gp table-container {{0}}" id="{{1}}">',[i.exec("containerClasses"),t.ID]),(t.search||t.create||t.toolbar)&&(r.add('<div class="table-toolbar">'),r.add(i.exec("toolbar")),r.add("<\/div>")),t.fixedheaders&&r.add('<div class="table-header">').add('<table class="table" cellpadding="0" cellspacing="0">').add(i.exec("header")).add("<\/table>").add("<\/div>"),r.addFormat('<div class="table-body{{0}}">',t.fixedheaders?" table-scroll":"").add('<table class="table" cellpadding="0" cellspacing="0"><tbody><\/tbody><\/table>').add("<\/div>"),t.fixedfooters&&r.add('<div class="table-footer"><\/div>'),t.pager&&r.add('<div class="table-pager"><\/div>'),r.add('<style type="text/css" class="column-width-style">').add(i.exec("columnWidthStyle")).add("<\/style>").add('<style type="text/css" class="sort-style"><\/style>').add('<div class="gp-progress-overlay">').add('<div class="gp-progress gp-progress-container">').add('<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><\/div>').add("<\/div>").add("<\/div>").add("<\/div>"),r.toString()};n.templates.container.$inject=["$config","$injector"];n.templates.containerClasses=function(n){var t=[];return n.fixedheaders&&t.push("fixed-headers"),n.fixedfooters&&t.push("fixed-footers"),n.pager&&t.push("pager-"+n.pager),n.responsive&&t.push("table-responsive"),n.search&&t.push("search-"+n.search),n.rowselected&&t.push("selectable"),n.containerclass&&t.push(n.containerclass),t.join(" ")};n.templates.containerClasses.$inject=["$config"];n.templates.editCellContent=function(t,i,r,u,f){var e=t,o=new n.StringBuilder,s;return e.edittemplate?typeof e.edittemplate=="function"?o.add(n.applyFunc(e.edittemplate,this,[i,e])):o.add(n.supplant.call(this,e.edittemplate,i,[i,e])):e.commands?o.add('<div class="btn-group').add(u.editmode=="inline"?" btn-group-xs":"").add('">').add(f.exec("button",{btnClass:"btn-primary",value:r=="create"?"create":"update",glyphicon:"glyphicon-save",text:"Save"})).add('<button type="button" class="btn btn-default" data-dismiss="modal" value="cancel">').add('<span class="glyphicon glyphicon-remove"><\/span>Cancel').add("<\/button>").add("<\/div>"):(s=i[e.field],n.hasValue(s)||(s=""),o.add(f.exec("input",{type:e.Type,name:e.field,value:"",required:t.required||!1}))),o.toString()};n.templates.editCellContent.$inject=["$column","$dataItem","$mode","$config","$injector"];n.templates.footer=function(t,i){var u=this,r=new n.StringBuilder;return r.add("<tfoot>").add("<tr>"),t.forEach(function(n){i.setResource("$column",n);r.add(i.exec("footerCell"))}),r.add("<\/tr>").add("<\/tfoot>"),r.toString()};n.templates.footer.$inject=["$columns","$injector"];n.templates.footerCell=function(t){var i=new n.StringBuilder;return i.add('<td class="footer-cell">').add(t.exec("footerCellContent")).add("<\/td>"),i.toString()};n.templates.footerCell.$inject=["$injector"];n.templates.footerCellContent=function(t,i){var r=new n.StringBuilder;return i.footertemplate&&(typeof i.footertemplate=="function"?r.add(n.applyFunc(i.footertemplate,this,[i,t])):r.add(n.supplant.call(this,i.footertemplate,i,[i,t]))),r.toString()};n.templates.footerCellContent.$inject=["$data","$column"];n.templates.footerTable=function(t){var i=new n.StringBuilder;return i.add('<table class="table" cellpadding="0" cellspacing="0">').add(t.exec("footer")).add("<\/table>"),i.toString()};n.templates.footerTable.$inject=["$injector"];n.templates.formGroup=function(t){return n.supplant.call(this,'<div class="form-group {{editclass}}"><label class="col-sm-4 control-label">{{{label}}}<\/label><div class="col-sm-6">{{{input}}}<\/div><\/div>',t)};n.templates.header=function(t,i,r){var u=new n.StringBuilder;return u.add("<thead><tr>"),t.forEach(function(n){u.add(r.setResource("$column",n).exec("headerCell"))}),u.add("<\/tr><\/thead>"),u.toString()};n.templates.header.$inject=["$columns","$config","$injector"];n.templates.headerCell=function(t,i,r){var e=this,u=new n.StringBuilder,f="";return i.sorting?f=n.escapeHTML(n.coalesce([t.sort,t.field])):n.hasValue(t.sort)&&(f=n.escapeHTML(t.sort)),u.add('<th class="header-cell '+(t.headerclass||"")+'"'),n.hasValue(f)&&u.addFormat(' data-sort="{{0}}"',f),u.add(">"),u.add(r.exec("headerCellContent")),u.add("<\/th>"),u.toString()};n.templates.headerCell.$inject=["$column","$config","$injector"];n.templates.headerCellContent=function(t,i){var f=this,r=new n.StringBuilder,u="";return i.sorting?u=n.escapeHTML(n.coalesce([t.sort,t.field])):n.hasValue(t.sort)&&(u=n.escapeHTML(t.sort)),t.headertemplate?typeof t.headertemplate=="function"?r.add(n.applyFunc(t.headertemplate,f,[t])):r.add(n.supplant.call(f,t.headertemplate,t,[t])):n.isNullOrEmpty(u)?r.escape(n.coalesce([t.header,t.field,""])):r.addFormat('<a href="javascript:void(0);" class="table-sort" value="sort" data-sort="{{0}}">',u).escape(n.coalesce([t.header,t.field,u])).add('<span class="glyphicon"><\/span>').add("<\/a>"),r.toString()};n.templates.headerCellContent.$inject=["$column","$config"];n.templates.input=function(t){var r={type:t.type=="boolean"?"checkbox":t.type=="number"?"number":"text",name:t.name,value:t.type=="boolean"?"true":t.type=="date"?n.format(t.value,"YYYY-MM-DD"):n.escapeHTML(t.value),checked:t.type=="boolean"&&t.value?" checked":"",dataType:/^date/.test(t.type)?' data-type="date"':"",required:t.required?" required":""},i=n.supplant.call(this,'<input type="{{type}}" name="{{name}}" value="{{value}}" class="form-control"{{{dataType}}}{{checked}}{{required}} />',r);return t.required&&(i+='<span class="required"><\/span>'),i};n.templates.pagerBar=function(t){var i=n.shallowCopy(t),r=new n.StringBuilder;return i.IsFirstPage=i.page===1,i.IsLastPage=i.page===i.pagecount,i.HasPages=i.pagecount>1,i.PreviousPage=i.page===1?1:i.page-1,i.NextPage=i.page===i.pagecount?i.pagecount:i.page+1,i.firstPageClass=i.IsFirstPage?"disabled":"",i.lastPageClass=i.IsLastPage?"disabled":"",i.HasPages&&r.add('<div class="btn-group">').add('<button class="ms-page-index btn btn-default {{firstPageClass}}" title="First page" value="page" data-page="1">').add('<span class="glyphicon glyphicon-triangle-left" aria-hidden="true"><\/span>').add("<\/button>").add('<button class="ms-page-index btn btn-default {{firstPageClass}}" title="Previous page" value="page" data-page="{{PreviousPage}}">').add('<span class="glyphicon glyphicon-menu-left" aria-hidden="true"><\/span>').add("<\/button>").add("<\/div>").add('<input type="number" name="page" value="{{page}}" class="form-control" style="width:75px;display:inline-block;vertical-align:middle" />').add('<span class="page-count"> of {{pagecount}}<\/span>').add('<div class="btn-group">').add('<button class="ms-page-index btn btn-default {{lastPageClass}}" title="Next page" value="page" data-page="{{NextPage}}">').add('<span class="glyphicon glyphicon-menu-right" aria-hidden="true"><\/span>').add("<\/button>").add('<button class="ms-page-index btn btn-default {{lastPageClass}}" title="Last page" value="page" data-page="{{pagecount}}">').add('<span class="glyphicon glyphicon-triangle-right" aria-hidden="true"><\/span>').add("<\/button>").add("<\/div>"),n.supplant.call(this,r.toString(),i)};n.templates.pagerBar.$inject=["$requestModel"];n.templates.sortStyle=function(t){var i={id:t.ID,sort:t.requestModel.sort,glyph:t.requestModel.desc?"\\e114":"\\e113"};return n.isNullOrEmpty(i.sort)?"":n.supplant('#{{id}} a.table-sort[data-sort="{{{sort}}}"] > span.glyphicon { display:inline; } #{{id}} a.table-sort[data-sort="{{{sort}}}"] > span.glyphicon:before { content:"{{{glyph}}}"; }',i)};n.templates.sortStyle.$inject=["$config"];n.templates.tableBody=function(t,i){var r=new n.StringBuilder;return r.add('<table class="table" cellpadding="0" cellspacing="0">'),t.fixedheaders||r.add(i.exec("header")),r.add("<tbody>").add(i.exec("tableRows")).add("<\/tbody>"),t.hasFooter&&!t.fixedfooters&&r.add(i.exec("footer")),r.add("<\/table>"),r.toString()};n.templates.tableBody.$inject=["$config","$injector"];n.templates.tableRow=function(t,i,r){var f=this,u=new n.StringBuilder;return u.addFormat('<tr data-uid="{{0}}"',r),/create|update/.test(i)&&u.add(' class="').add(i).add('-mode"'),u.add(">").add(t.exec("tableRowCells")).add("<\/tr>"),u.toString()};n.templates.tableRow.$inject=["$injector","$mode"];n.templates.tableRowCell=function(t,i,r){var e=this,f=r||"read",u=new n.StringBuilder;return u.addFormat('<td class="body-cell {{0}}{{1}}">',[t.commands?"commands ":"",t.bodyclass]),/create|update/.test(f)&&!t.readonly?u.add(i.exec("editCellContent")):u.add(i.exec("bodyCellContent")),u.add("<\/td>"),u.toString()};n.templates.tableRowCell.$inject=["$column","$injector","$mode"];n.templates.tableRowCells=function(t,i){var u=this,r=new n.StringBuilder;return t.forEach(function(n){i.setResource("$column",n);r.add(i.exec("tableRowCell"))}),r.toString()};n.templates.tableRowCells.$inject=["$columns","$injector"];n.templates.tableRows=function(t,i,r){var e=this,u=new n.StringBuilder,f;return t==null?"":(t.forEach(function(n){r.setResource("$dataItem",n);f=i.assign(n);u.add(r.exec("tableRow",f))}),u.toString())};n.templates.tableRows.$inject=["$data","$map","$injector"];n.templates.toolbar=function(t,i){var r=new n.StringBuilder;return t.search&&r.add('<div class="input-group searchbox">').add('<input type="text" name="search" class="form-control" placeholder="Search...">').add('<span class="input-group-btn">').add(i.exec("button",{btnClass:"btn-default",value:"search",glyphicon:"glyphicon-search"})).add("<\/span>").add("<\/div>"),t.create&&r.add(i.exec("button",{btnClass:"btn-default",value:"AddRow",glyphicon:"glyphicon-plus",text:"Add"})),r.toString()};n.templates.toolbar.$inject=["$config","$injector"],function(n){var u=[/&/g,/</g,/>/g,/"/g,/'/g,/`/g],f=["&amp;","&lt;","&gt;","&quot;","&apos;","&#96;"],t=Function.prototype,i=t.bind?t.bind.bind(t.call):function(n){return function(t){return function(){return n.apply(t,arguments)}}}(t.call),r={},e=i("".slice),o=i(0..toString);$.extend(n,{applyFunc:function(t,i,r,u){if(typeof t=="function")try{return r==undefined?t.call(i):(r=Array.isArray(r)?r:[r],t.apply(i,r))}catch(f){u=u||n.error;n.applyFunc(u,i,f)}},coalesce:function(t){if(n.isNullOrEmpty(t))return t;for(var i=0;i<t.length;i++)if(n.hasValue(t[i]))return t[i];return t[t.length-1]},createUID:function(n){function t(){return n.apply(this,arguments)}return t.toString=function(){return n.toString()},t}(function(){var n="gp"+e(o(Math.random(),36),2);return n in r?createUID():r[n]=n}),disable:function(t,i){$(t).attr("disabled","disabled").addClass("disabled busy");typeof i=="number"&&i>0&&setTimeout(function(){n.enable(t)},i*1e3)},enable:function(n){$(n).removeAttr("disabled").removeClass("disabled busy")},escapeHTML:function(n){return typeof n!="string"?n:(u.forEach(function(t,i){n=n.replace(t,f[i])}),n)},format:function(t,i){var r=n.getType(t);try{if(/^(date|datestring)$/.test(r))return window.moment?(i=i||"M/D/YYYY h:mm a",moment(t).format(i)):t;if(r==="timestamp")return window.moment?(i=i||"M/D/YYYY h:mm a",t=parseInt(t.match(n.rexp.timestamp)[1]),moment(t).format(i)):t;if(r==="number")return window.numeral?(i=i||"0,0",numeral(t).format(i)):t}catch(u){n.error(u)}return t},getAttributes:function(t){for(var u={},f,i,e=$(t)[0].attributes,r=e.length-1;r>=0;r--)i=e[r],f=i.name.toLowerCase().replace("-",""),u[f]=n.rexp.trueFalse.test(i.value)||i.value===""?i.value==="true"||i.value==="":i.value;return u},getColumnByField:function(n,t){var i=n.filter(function(n){return n.field===t||n.sort===t});return i.length?i[0]:null},getCommand:function(n,t){var i=[],r;return n.forEach(function(n){Array.isArray(n.commands)&&(i=i.concat(n.commands))}),r=i.filter(function(n){return n.value===t}),r.length>0?r[0]:void 0},getDefaultValue:function(n){switch(n){case"number":return 0;case"boolean":return!1;case"date":default:return null}},getFormattedValue:function(t,i,r){var f=(i.Type||"").toLowerCase(),u=f==="function"?i.field(t):t[i.field];return/^(date|datestring|timestamp)$/.test(f)?n.format(u,i.format):/^(number|function)$/.test(f)&&i.format?n.format(u,i.format):f===""&&i.format&&/^(?:\d*\.)?\d+$/.test(u)?n.format(parseFloat(u),i.format):f==="string"&&r?n.escapeHTML(u):u},getMatchCI:function(t,i){var u,r;if(n.isNullOrEmpty(t)||!n.hasValue(i))return null;for(u=i.toLowerCase(),r=0;r<t.length;r++)if(n.hasValue(t[r])&&t[r].toLowerCase()===u)return t[r];return null},getObjectAtPath:function(t,i){var u,r,f;if(typeof t!="string")return t;for(u=i||window,t=t.match(n.rexp.splitPath),t[0]==="window"&&(t=t.splice(1)),f=0;f<t.length;f++)if(r=t[f],n.rexp.indexer.test(r)?r=parseInt(/\d+/.exec(r)):n.rexp.quoted.test(r)&&(r=r.slice(1,-1)),u=u[r],u===undefined)return;return u},getTableRow:function(n,t,i){var r=n.getUid(t);if(r!=-1)return $(i).find('tr[data-uid="'+r+'"]')},getType:function(t){if(t===null||t===undefined)return t;var i=typeof t;return i==="string"?n.rexp.iso8601.test(t)?"datestring":n.rexp.timestamp.test(t)?"timestamp":i:i==="number"||i==="boolean"||i==="function"?i:t instanceof Date?"date":Array.isArray(t)?"array":i},hasValue:function(n){return n!==undefined&&n!==null},"implements":function(t,i){var r;if(typeof t!=typeof i)return!1;if(!n.hasValue(t))return!0;var e=function(n){return n.toLowerCase()},u=Object.getOwnPropertyNames(t).map(e),f=Object.getOwnPropertyNames(i).map(e);if(u.length<f.length){for(r=0;r<u.length;r++)if(f.indexOf(u[r])===-1)return!1}else for(r=0;r<f.length;r++)if(u.indexOf(f[r])===-1)return!1;return!0},isNullOrEmpty:function(t){return n.hasValue(t)===!1||t.length!=undefined&&t.length===0},resolveTypes:function(t){var i,r,u=t&&t.requestModel&&t.requestModel.data&&t.requestModel.data.length;t.columns.forEach(function(f){if(!n.hasValue(f.Type)&&(i=n.hasValue(f.field)?f.field:f.sort,!n.isNullOrEmpty(i))){if(typeof i=="function"){f.Type="function";return}if(t.model&&n.hasValue(t.model[i])&&n.getType(t.model[i])!=="function"&&(f.Type=n.getType(t.model[i])),!n.hasValue(f.Type)&&u)for(var e=0;e<t.requestModel.data.length&&e<25;e++)if(r=t.requestModel.data[e][i],r!==null){f.Type=n.getType(r);break}}})},resolveResponseModel:function(t,i){if(!n.hasValue(t))return null;var r=new n.ResponseModel;if(n["implements"](t,r))n.shallowCopy(t,r,!0);else if(t.data&&t.data.length)r.dataItem=t.data[0];else if(t.length)r.dataItem=t[0];else if(n["implements"](t,i))r.dataItem=t;else throw new Error("Could not resolve JSON response.");return r},rexp:{splitPath:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/,iso8601:/^[012][0-9]{3}-[01][0-9]-[0123][0-9]/,timestamp:/\/Date\((\d+)\)\//,quoted:/^['"].+['"]$/,trueFalse:/true|false/i,json:/^\{.*\}$|^\[.*\]$/,copyable:/^(object|date|array|function)$/},shallowCopy:function(t,i,r){if(i=i||{},!n.rexp.copyable.test(n.getType(t)))return i;var f,u,e=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(i);return e.forEach(function(e){(u=r?n.getMatchCI(o,e)||e:e,!i.hasOwnProperty(e)||(f=Object.getOwnPropertyDescriptor(i,e),f.writable))&&(i[u]=typeof t[e]=="function"?t[e]():t[e])}),i},supplant:function(t,i,r){var e=this,f,o=/^(string|number|boolean|date|datestring|timestamp)$/,u;return t=t.replace(/{{{([^{}]*)}}}/g,function(t,s){return(u=n.getObjectAtPath(s,i),f=n.getType(u),o.test(f))?u:f==="function"?n.applyFunc(u,e,r):(u=n.getObjectAtPath(s),typeof u=="function"?n.applyFunc(u,e,r):"")}),t.replace(/{{([^{}]*)}}/g,function(t,s){return(u=n.getObjectAtPath(s,i),f=n.getType(u),o.test(f))?n.escapeHTML(u):f==="function"?n.escapeHTML(n.applyFunc(u,e,r)):(u=n.getObjectAtPath(s),typeof u=="function"?n.escapeHTML(n.applyFunc(u,e,r)):"")})},log:window.console?window.console.log.bind(window.console):function(){},error:function(n){console&&console.error&&console.error(n)}})}(gridponent);document.registerElement?(n.Gridponent=Object.create(HTMLElement.prototype),n.Gridponent.createdCallback=function(){var t=new n.Initializer(this);$(t.initialize.bind(t))},n.Gridponent.detachedCallback=function(){var n=this.querySelector(".table-container");n&&n.api&&n.api.dispose()},document.registerElement("grid-ponent",{prototype:n.Gridponent})):(n.initialize=function(t){var r,i;for(t=$(t||document)[0],r=t.querySelectorAll("grid-ponent"),i=0;i<r.length;i++)new n.Initializer(r[i]).initialize()},$(function(){n.initialize()}))})(gridponent);