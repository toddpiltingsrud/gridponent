"use strict";var gridponent=gridponent||function(n,t){var r,u,f,i;if(typeof n=="string"&&(n=document.querySelector(n)),n instanceof HTMLElement){if(r=n.querySelector(".table-container"),r&&r.api)return r.api;if(t)return u=new gridponent.Initializer(n),f=u.initializeOptions(t),f.node.api}return i={api:null,callback:function(){},ready:function(n){i.api?i.api.ready(n):i.callback=n}},gridponent.ready(function(){var r,f,u;typeof n=="string"&&(n=document.querySelector(n));n instanceof HTMLElement&&(r=n.querySelector(".table-container"),r&&r.api&&(i.callback?r.api.ready(i.callback):i.api=r.api),t&&(f=new gridponent.Initializer(n),u=f.initializeOptions(t),i.callback?u.node.api.ready(i.callback):i.api=u.node.api))}),i};(function(n){n.events={rowSelected:"rowselected",beforeInit:"beforeinit",beforeRead:"beforeread",beforeEdit:"beforeedit",onRead:"onread",onEdit:"onedit",editReady:"editready",httpError:"httpError",ready:"ready"};n.api=function(n){this.controller=n;this.config=n.config;this.$n=$(this.config.node)};n.api.prototype={create:function(n){return this.controller.addRow(n),this},destroy:function(n,t){return this.controller.deleteRow(n,t,!0),this},dispose:function(){return this.controller.dispose(),this},find:function(n){return this.$n.find(n).addBack(n)},getData:function(n){return n!=undefined?this.config.map.get(n):this.controller.config.pageModel.data},getTableRow:function(t){return n.getTableRow(this.controller.config.map,t,this.controller.config.node)},read:function(n,t){return this.controller.read(n,t),this},refresh:function(n){return this.controller.read(null,n),this},search:function(t,i){return t=n.isNullOrEmpty(t)?"":t.toString(),this.controller.search(t,i),this},sort:function(t,i,r){return t=n.isNullOrEmpty(t)?"":t.toString(),typeof i=="boolean"?i:i==="false"?!1:!!i,this.controller.sort(t,i,r),this},toggleBusy:function(t){return t=t===!0||t===!1?t:!n.hasClass(this.config.node,"busy"),t?this.$n.addClass("busy"):this.$n.removeClass("busy"),this}};Object.getOwnPropertyNames(n.events).forEach(function(t){n.api.prototype[t]=function(i){return typeof i=="function"&&this.controller.addDelegate(n.events[t],i),this}});n.api.prototype.ready=function(n){return this.controller.ready(n),this};n.api.prototype.rowSelected=function(t){return typeof t=="function"&&(this.controller.addDelegate(n.events.rowSelected,t),this.$n.addClass("selectable")),this};n.Controller=function(n,t,i,r){this.config=n;this.model=t;this.$n=$(n.node);this.requestModel=i;this.injector=r;n.pager&&(this.requestModel.top=25);this.handlers={readHandler:this.read.bind(this),commandHandler:this.commandHandler.bind(this),rowSelectHandler:this.rowSelectHandler.bind(this),httpErrorHandler:this.httpErrorHandler.bind(this),toolbarChangeHandler:this.toolbarChangeHandler.bind(this),toolbarEnterKeyHandler:this.toolbarEnterKeyHandler.bind(this)};this.done=!1;this.eventDelegates={};this.addBusyDelegates()};n.Controller.prototype={init:function(){var t=this;this.addCommandHandlers(this.config.node);this.addRowSelectHandler(this.config);this.addRefreshEventHandler(this.config);this.addToolbarChangeHandler();this.done=!0;this.invokeDelegates(n.events.ready,this.config.node.api)},addBusyDelegates:function(){this.addDelegate(n.events.beforeRead,this.addBusy);this.addDelegate(n.events.onRead,this.removeBusy);this.addDelegate(n.events.beforeEdit,this.addBusy);this.addDelegate(n.events.onEdit,this.removeBusy);this.addDelegate(n.events.httpError,this.removeBusy)},addBusy:function(){this.$n.addClass("busy")},removeBusy:function(){this.$n.removeClass("busy")},ready:function(t){this.done?n.applyFunc(t,this.config.node.api,this.config.node.api):this.addDelegate(n.events.ready,t)},addDelegate:function(n,t){this.eventDelegates[n]=this.eventDelegates[n]||[];this.eventDelegates[n].push(t)},invokeDelegates:function(t,i){var f=this,r=!0,u=this.eventDelegates[t];return Array.isArray(u)&&u.forEach(function(t){r!==!1&&(r=n.applyFunc(t,f.config.node.api,i))}),r},addToolbarChangeHandler:function(){var n=".table-toolbar [name], thead input, .table-pager input";this.$n.on("change",n,this.handlers.toolbarChangeHandler);this.$n.on("keydown",n,this.handlers.toolbarEnterKeyHandler)},removeToolbarChangeHandler:function(){this.$n.off("change",this.handlers.toolbarChangeHandler);this.$n.off("keydown",this.handlers.toolbarEnterKeyHandler)},toolbarEnterKeyHandler:function(n){if(n.keyCode==13){n.target.blur();return}},toolbarChangeHandler:function(t){var i=t.target.name,r=this.config.pageModel,u=n.getType(r[i]),f=n.ModelSync.cast(t.target.value,u);r[i]=f;this.read()},addCommandHandlers:function(n){$(n).on("click","button[value],a[value]",this.handlers.commandHandler)},removeCommandHandlers:function(n){$(n).off("click",this.handlers.commandHandler)},commandHandler:function(t){var s,u=$(t.target),f=u.closest("tr[data-uid],div.modal",this.config.node),e=f.length?this.config.map.get(f[0]):null,h=u.attr("value"),r=n.getCommand(this.config.columns,h),i=this.config.pageModel,c,o;if(r&&typeof r.func=="function"){r.func.call(this.config.node.api,e);return}s=(h||"").toLowerCase();switch(s){case"addrow":this.addRow();break;case"edit":this.editRow(e,f);break;case"delete":case"destroy":this.deleteRow(e,f);break;case"page":c=u.attr("data-page");i.page=parseInt(c);this.read();break;case"search":i.search=this.$n.find(".table-toolbar input[name=search]").val();this.read();break;case"sort":o=u.attr("data-sort");i.sort===o?i.desc=!i.desc:(i.sort=o,i.desc=!1);this.read();break;default:r=n.getObjectAtPath(u.val());typeof r=="function"&&r.call(this.config.node.api,e)}},getEditor:function(t){var r=this,i;return i=t==undefined?new n.Editor(this.config,this.model,this.injector):t=="modal"?new n.ModalEditor(this.config,this.model,this.injector):new n.TableRowEditor(this.config,this.model,this.injector),i.beforeEdit=function(t){r.invokeDelegates(n.events.beforeEdit,t)},i.afterEdit=function(t){r.invokeDelegates(n.events.onEdit,t)},i.editReady=function(t){r.invokeDelegates(n.events.editReady,t)},i},addRowSelectHandler:function(){this.$n.on("click","div.table-body > table > tbody > tr > td.body-cell",this.handlers.rowSelectHandler)},removeRowSelectHandler:function(){this.$n.off("click",this.handlers.rowSelectHandler)},rowSelectHandler:function(t){var i=this.config,f=$(t.target).closest("tr",i.node),o=this.$n.find("div.table-body > table > tbody > tr.selected"),r=typeof i.rowselected,u,e;(r==="string"&&i.rowselected.indexOf("{{")!==-1&&(r="urlTemplate"),o.removeClass("selected"),$(f).addClass("selected"),u=i.map.get(f),e=this.invokeDelegates(n.events.rowSelected,u),e!==!1)&&r==="urlTemplate"&&(window.location=n.supplant.call(this.config.node.api,i.rowselected,u))},addRefreshEventHandler:function(n){if(n.refreshevent)$(document).on(n.refreshevent,this.handlers.readHandler)},removeRefreshEventHandler:function(n){n.refreshevent&&$(document).off(n.refreshevent,this.handlers.readHandler)},search:function(n,t){this.config.pageModel.search=n;this.$n.find("div.table-toolbar input[name=search]").val(n);this.read(null,t)},sort:function(n,t,i){this.config.pageModel.sort=n;this.config.pageModel.desc=t==!0;this.read(null,i)},read:function(t,i){var r=this,u=!0;(t&&n.shallowCopy(t,this.config.pageModel),u=this.invokeDelegates(n.events.beforeRead,this.config.node.api),u!==!1)&&this.model.read(this.config.pageModel,function(t){try{n.shallowCopy(t,r.config.pageModel,!0);r.injector.setResource("$data",r.config.pageModel.data);r.config.map.clear();n.resolveTypes(r.config);r.refresh(r.config);r.invokeDelegates(n.events.onRead,r.config.node.api);n.applyFunc(i,r.config.node,r.config.pageModel)}catch(u){r.removeBusy();r.httpErrorHandler(u)}},this.handlers.httpErrorHandler)},addRow:function(n){var t=this.getEditor(this.config.editmode),i=t.add(n);return t},editRow:function(n,t){var i=this.getEditor(this.config.editmode),r=i.edit(n,t);return i},deleteRow:function(t,i,r){try{if(!n.hasValue(this.config.destroy)){n.applyFunc(i,this.config.node);return}var u=this,e=r||confirm("Are you sure you want to delete this item?"),f=n.getTableRow(this.config.map,t,this.$n[0]);if(!e){n.applyFunc(i,this.config.node);return}this.invokeDelegates(n.events.beforeEdit,{type:"destroy",dataItem:t,elem:f});this.model.destroy(t,function(r){try{if(!r||!r.errors){var e=u.config.pageModel.data.indexOf(t);e!=-1&&u.config.pageModel.data.splice(e,1);u.refresh(u.config)}}catch(o){n.error(o)}u.invokeDelegates(n.events.onEdit,{type:"destroy",dataItem:t,elem:f});n.applyFunc(i,u.config.node.api,r)},u.handlers.httpErrorHandler)}catch(o){this.removeBusy();this.httpErrorHandler(o)}},refresh:function(){try{var t=this.$n.find("div.table-body"),i=this.$n.find("div.table-footer"),r=this.$n.find("div.table-pager");this.config.map.clear();t.html(this.injector.exec("tableBody"));i.html(this.injector.exec("footerTable"));r.html(this.injector.exec("pagerBar"));n.helpers.sortStyle(this.config)}catch(u){n.error(u)}},httpErrorHandler:function(t){this.invokeDelegates(n.events.httpError,t);alert("An error occurred while carrying out your request.");n.error(t)},dispose:function(){this.removeRefreshEventHandler(this.config);this.removeRowSelectHandler();this.removeCommandHandlers(this.config.node);this.removeToolbarChangeHandler()}};n.DataLayer=function(n){this.config=n;this.reader=null};n.DataLayer.prototype={getReader:function(){var t=n.getType(this.config.read);switch(t){case"string":return new n.ServerPager(this.config.read);case"function":return new n.FunctionPager(this.config);case"object":return this.config.pageModel=this.config.read,new n.ClientPager(this.config);case"array":return this.config.pageModel.data=this.config.read,new n.ClientPager(this.config);default:throw"Unsupported read configuration";}},read:function(t,i,r){var u=this;this.reader||(this.reader=this.getReader());this.reader.read(t,function(t){t=u.resolveResult(t);n.applyFunc(i,u,[t])},function(t){n.applyFunc(r,u,[t])})},create:function(t,i,r){var u=this,f,e;typeof this.config.create=="function"?n.applyFunc(this.config.create,this.config.node.api,[t,i,r],r):(f=n.supplant(this.config.create,t),e=new n.Http,e.post(f,t,function(t){n.applyFunc(i,u,t)},function(t){n.applyFunc(r,u,t)}))},update:function(t,i,r){var u=this,f,e;typeof this.config.update=="function"?n.applyFunc(this.config.update,this.config.node.api,[t,i,r],r):(f=n.supplant(this.config.update,t),e=new n.Http,e.post(f,t,function(t){n.applyFunc(i,u,t)},function(t){n.applyFunc(r,u,t)}))},destroy:function(t,i,r){var u=this,f,e;typeof this.config.destroy=="function"?n.applyFunc(this.config.destroy,this.config.node.api,[t,i,r],r):(f=n.supplant(this.config.destroy,t),e=new n.Http,e.destroy(f,function(t){n.applyFunc(i,u,t)},function(t){n.applyFunc(r,u,t)}))},resolveResult:function(t){return n.hasValue(t)&&Array.isArray(t)?new n.PagingModel(t):t}};n.DataMap=function(){this.uid=0;this.map={}};n.DataMap.prototype={assign:function(n,t){var i=++this.uid;return this.map[i]=n,t&&t.setAttribute&&t.setAttribute("data-uid",i.toString()),i},get:function(n){var t=this.resolveUid(n);return this.map[t]},getUid:function(n){for(var t,r=Object.getOwnPropertyNames(this.map),i=0;i<r.length;i++)if(t=r[i],this.map[t]===n)return t;return-1},resolveUid:function(n){var t=-1;return($.isNumeric(n)?t=parseInt(n):$(n).is("[data-uid]")&&(t=parseInt($(n).attr("data-uid"))),isNaN(t))?-1:t},remove:function(n){var t=this.resolveUid(n);t in this.map&&delete this.map[t]},clear:function(){this.uid=0;this.map={}}};n.Editor=function(n,t,i){this.config=n;this.dal=t;this.uid=null;this.dataItem=null;this.originalDataItem=null;this.mode=null;this.beforeEdit=null;this.afterEdit=null;this.editReady=null;this.button=null;this.$n=$(n.node);this.injector=i};n.Editor.prototype={add:function(n){return this.dataItem=n||this.createDataItem(),this.injector.setResource("$dataItem",this.dataItem).setResource("$mode","create"),this.mode="create",this.config.pageModel.data.push(this.dataItem),this.uid=this.config.map.assign(this.dataItem),{dataItem:this.dataItem,uid:this.uid}},edit:function(t){return this.dataItem=t,this.injector.setResource("$dataItem",t).setResource("$mode","update"),this.originalDataItem=n.shallowCopy(t),this.mode="update",{dataItem:t}},cancel:function(){if(this.mode==="create"){this.config.map.remove(this.uid);var t=this.config.pageModel.data.indexOf(this.dataItem);t!==-1&&this.config.pageModel.data.slice(t,1)}else this.mode=="update"&&this.originalDataItem&&n.shallowCopy(this.originalDataItem,this.dataItem);this.removeCommandHandler()},httpErrorHandler:function(t){alert("An error occurred while carrying out your request.");n.error(t)},save:function(t,i){var r=this,u,f,i=i||n.error;this.addBusy();this.elem&&(f=n.ModelSync.serialize(this.elem),n.ModelSync.castValues(f,this.config.columns),n.shallowCopy(f,this.dataItem));typeof this.beforeEdit=="function"&&this.beforeEdit({type:this.mode,dataItem:this.dataItem,elem:this.elem});this.mode=="create"?this.dal.create(this.dataItem,function(f){try{f=n.shallowCopy(f,null,!0);n.hasValue(f.errors)?r.validate(f):(u=n.hasValue(f.dataItem)?f.dataItem:f.data&&f.data.length?f.data[0]:r.dataItem,n.shallowCopy(u,r.dataItem),r.updateUI(r.config,r.dataItem,r.elem),r.removeCommandHandler&&r.removeCommandHandler())}catch(e){var o=i||n.error;o(e)}r.button instanceof HTMLElement&&n.enable(r.button);r.removeBusy();typeof r.afterEdit=="function"&&r.afterEdit({type:r.mode,dataItem:r.dataItem,elem:r.elem});n.applyFunc(t,r.config.node.api,f)},function(t){r.removeBusy();n.applyFunc(i,r,t)}):this.dal.update(this.dataItem,function(f){try{f=n.shallowCopy(f,null,!0);n.hasValue(f.errors)?r.validate(f):(u=n.hasValue(f.dataItem)?f.dataItem:f.data&&f.data.length?f.data[0]:r.dataItem,n.shallowCopy(u,r.dataItem),r.elem&&(r.updateUI(r.config,r.dataItem,r.elem),r.removeCommandHandler&&r.removeCommandHandler()))}catch(e){i(e)}r.button instanceof HTMLElement&&n.enable(r.button);r.removeBusy();typeof r.afterEdit=="function"&&r.afterEdit({type:r.mode,dataItem:r.dataItem,elem:r.elem});n.applyFunc(t,r.config.node,f)},function(t){r.removeBusy();n.applyFunc(i,r,t)})},addBusy:function(){this.$n.addClass("busy")},removeBusy:function(){this.$n.removeClass("busy")},updateUI:function(){},validate:function(){},createDataItem:function(){var t={};return this.config.columns.forEach(function(i){var r=i.field||i.sort;n.hasValue(r)&&(t[r]=n.hasValue(i.Type)?n.getDefaultValue(i.Type):"")}),typeof this.config.model=="object"&&n.shallowCopy(this.config.model,t),t}};n.TableRowEditor=function(t,i,r){var u=this;n.Editor.call(this,t,i,r);this.elem=null;this.commandHandler=function(t){var i=$(this).val();/^(create|update|save)$/i.test(i)?(u.button=t.target,n.disable(u.button,5),u.save(null,u.httpErrorHandler)):/^cancel$/i.test(i)&&u.cancel()}};n.TableRowEditor.prototype={save:n.Editor.prototype.save,addBusy:n.Editor.prototype.addBusy,removeBusy:n.Editor.prototype.removeBusy,httpErrorHandler:n.Editor.prototype.httpErrorHandler,createDataItem:n.Editor.prototype.createDataItem,addCommandHandler:function(){$(this.elem).on("click","button[value]",this.commandHandler)},removeCommandHandler:function(){$(this.elem).off("click",this.commandHandler)},add:function(t){var r=this,u=this.$n.find("div.table-body > table > tbody"),i=new n.NodeBuilder,f,e=n.Editor.prototype.add.call(this,t);return i.create("tr").addClass("create-mode").attr("data-uid",e.uid),this.config.columns.forEach(function(n){r.injector.setResource("$column",n).setResource("$mode","create");f=n.readonly?r.injector.exec("bodyCellContent"):r.injector.exec("editCellContent");i.create("td").addClass("body-cell").addClass(n.bodyclass).html(f);n.commands&&i.addClass("commands");n.editclass&&i.addClass(n.editclass);i.endElem()}),this.elem=i.close(),n.ModelSync.bindElements(this.dataItem,this.elem),this.addCommandHandler(),this.config.newrowposition==="top"?u.prepend(this.elem):u.append(this.elem),this.invokeEditReady(),{dataItem:this.dataItem,elem:this.elem}},edit:function(t,i){var u=this,r,f=$(i).find("td.body-cell");return n.Editor.prototype.edit.call(this,t),this.elem=i,this.addCommandHandler(),f.each(function(n){r=u.config.columns[n];u.injector.setResource("$column",r).setResource("$mode","edit");r.readonly||($(this).html(u.injector.exec(" editCellContent ")),r.editclass&&$(this).addClass(r.editclass))}),$(i).addClass("edit-mode"),n.ModelSync.bindElements(t,this.elem),this.invokeEditReady(),{dataItem:t,elem:this.elem}},cancel:function(){n.Editor.prototype.cancel.call(this);try{var t=$(this.elem).closest("table",this.$n);$(this.elem).hasClass("create-mode")?t[0].deleteRow(this.elem.rowIndex):this.updateUI()}catch(i){n.error(i)}},validate:function(t){if(typeof this.config.validate=="function")n.applyFunc(this.config.validate,this,[this.elem,t]);else{var r=this,i=new n.StringBuilder,u;i.add("Please correct the following errors:\r\n");$(r.elem).find("[name].error").removeClass("error");Object.getOwnPropertyNames(t.errors).forEach(function(n){$(r.elem).find('[name="'+n+'"]').addClass("error");u=t.errors[n].errors;i.add(n+":\r\n").add(u.map(function(n){return"    - "+n+"\r\n"}).join(""))});alert(i.toString())}},updateUI:function(){var t=this,n,i=$(this.elem).find("td.body-cell");i.each(function(i){n=t.config.columns[i];t.injector.setResource("$column",n);$(this).html(t.injector.exec("bodyCellContent"));n.editclass&&$(this).removeClass(n.editclass)});$(this.elem).removeClass("edit-mode create-mode")},invokeEditReady:function(){typeof this.editReady=="function"&&this.editReady({dataItem:this.dataItem,elem:this.elem})}};n.ModalEditor=function(t,i,r){n.TableRowEditor.call(this,t,i,r)};n.ModalEditor.prototype={save:n.Editor.prototype.save,addBusy:n.Editor.prototype.addBusy,removeBusy:n.Editor.prototype.removeBusy,httpErrorHandler:n.Editor.prototype.httpErrorHandler,addCommandHandler:n.TableRowEditor.prototype.addCommandHandler,removeCommandHandler:n.TableRowEditor.prototype.removeCommandHandler,validate:n.TableRowEditor.prototype.validate,createDataItem:n.Editor.prototype.createDataItem,invokeEditReady:n.TableRowEditor.prototype.invokeEditReady,add:function(t){var r=this,u,i;n.Editor.prototype.add.call(this,t);u=this.injector.exec("bootstrapModalContent");i=$(u).appendTo(this.config.node).one("shown.bs.modal",r.invokeEditReady.bind(r));this.elem=i[0];i.modal({show:!0,keyboard:!0,backdrop:"static"});n.ModelSync.bindElements(this.dataItem,this.elem);i.one("hidden.bs.modal",function(){$(i).remove()});return this.addCommandHandler(),{dataItem:this.dataItem,elem:this.elem}},edit:function(t){var r=this,u,i;n.Editor.prototype.edit.call(this,t);u=this.injector.exec("bootstrapModalContent");i=$(u).appendTo(this.config.node).one("shown.bs.modal",r.invokeEditReady.bind(r));this.elem=i[0];i.modal({show:!0,keyboard:!0,backdrop:"static"});n.ModelSync.bindElements(t,this.elem);i.one("hidden.bs.modal",function(){$(i).remove()});return this.addCommandHandler(),{dataItem:t,elem:this.elem}},cancel:function(){n.Editor.prototype.cancel.call(this);$(this.elem).modal("hide")},updateUI:function(){var i=this,f=this.$n.find("div.table-body > table > tbody"),t,e,r,u,o;$(this.elem).modal("hide");this.mode=="create"?(r=this.config.map.resolveUid(this.elem),r==-1&&(r=this.config.map.assign(this.dataItem)),u=(new n.NodeBuilder).create("tr").attr("data-uid",r),this.config.columns.forEach(function(n){o=i.injector.setResource("$column",n).exec("bodyCellContent");u.create("td").addClass("body-cell").addClass(n.bodyclass).html(o).endElem()}),t=u.close(),this.config.newrowposition==="top"?f.prepend(t):f.append(t)):(t=n.getTableRow(this.config.map,this.dataItem,this.config.node),t&&$(t).find("td.body-cell").each(function(n){e=i.config.columns[n];i.injector.setResource("$column",e);$(this).html(i.injector.exec("bodyCellContent"))}))}};n.Formatter=function(){};n.Formatter.prototype={format:function(t,i){var r=n.getType(t);try{if(/^(date|datestring)$/.test(r))return i=i||"M/D/YYYY h:mm a",moment(t).format(i);if(r==="timestamp")return i=i||"M/D/YYYY h:mm a",t=parseInt(t.match(n.rexp.timestamp)[1]),moment(t).format(i);if(r==="number")return i=i||"0,0",numeral(t).format(i)}catch(u){n.error(u)}return t}};n.helpers={setPagerFlags:function(){this.pageModel.IsFirstPage=this.pageModel.page===1;this.pageModel.IsLastPage=this.pageModel.page===this.pageModel.pagecount;this.pageModel.HasPages=this.pageModel.pagecount>1;this.pageModel.PreviousPage=this.pageModel.page===1?1:this.pageModel.page-1;this.pageModel.NextPage=this.pageModel.page===this.pageModel.pagecount?this.pageModel.pagecount:this.pageModel.page+1},sortStyle:function(t){var i=$(t.node).find("a.table-sort > span.glyphicon-chevron-up,a.table-sort > span.glyphicon-chevron-down").removeClass("glyphicon-chevron-up glyphicon-chevron-down");n.isNullOrEmpty(t.pageModel.sort)||$(t.node).find('a.table-sort[data-sort="'+t.pageModel.sort+'"] > span').addClass(t.pageModel.desc?"glyphicon-chevron-down":"glyphicon-chevron-up")}};n.Initializer=function(n){this.parent=$(n)};n.Initializer.prototype={initialize:function(n){return this.config=this.getConfig(this.parent),this.initializeOptions(this.config,n)},initializeOptions:function(t,i){var r=this,f,u;return t.pageModel={},t.ID=n.createUID(),this.config=t,this.config.map=new n.DataMap,this.config.pageModel=new n.PagingModel,this.config.editmode=this.config.editmode||"inline",this.config.newrowposition=this.config.newrowposition||"top",this.injector=new n.Injector({$config:this.config,$columns:this.config.columns,$node:this.config.node,$pageModel:this.config.pageModel,$map:this.config.map,$data:this.config.pageModel.data},n.templates,null,this.config),this.renderLayout(this.config,this.parent),this.config.node=this.parent.find(".table-container")[0],this.$n=this.parent.find(".table-container"),f=new n.DataLayer(this.config),u=new n.Controller(this.config,f,this.config.pageModel,this.injector),this.config.node.api=new n.api(u),this.config.hasFooter=this.resolveFooter(this.config),this.config.preload=this.config.preload===!1?this.config.preload:!0,this.injector.context=this.config.node.api,setTimeout(function(){r.resolveTopLevelOptions(r.config);r.addEventDelegates(r.config,u);u.invokeDelegates(n.events.beforeInit,r.config);r.config.preload?(u.invokeDelegates(n.events.beforeRead,r.config.pageModel),f.read(r.config.pageModel,function(t){try{n.shallowCopy(t,r.config.pageModel,!0);r.injector.setResource("$data",r.config.pageModel.data);n.resolveTypes(r.config);r.resolveCommands(r.config);r.render(r.config);u.init();typeof i=="function"&&i(r.config)}catch(f){n.error(f)}u.invokeDelegates(n.events.onRead,r.config.pageModel)},function(t){u.invokeDelegates(n.events.httpError,t);alert("An error occurred while carrying out your request.");n.error(t)})):(n.resolveTypes(r.config),r.resolveCommands(r.config),u.init())}),this.config},getConfig:function(t){var f=this,r,u,i=n.getAttributes(t),e=$(t).find("gp-column");return i.columns=[],u="header body edit footer".split(" "),e.each(function(){r=n.getAttributes(this);i.columns.push(r);f.resolveTemplates(u,r,this)}),this.resolveTemplates(["toolbar","footer"],i,t),i},addEventDelegates:function(t,i){var f=this,u,r,e=t.node.api;Object.getOwnPropertyNames(n.events).forEach(function(f){u=n.events[f];r=t[u];typeof r=="string"&&(r=n.getObjectAtPath(r));typeof r=="function"&&(t[u]=r,i.addDelegate(u,r))})},renderLayout:function(t,i){try{$(i).html(this.injector.exec("container"))}catch(r){n.error(r)}},render:function(t){var i=this,r;try{var s=t.node,u=this.$n.find("div.table-body"),f=this.$n.find("div.table-footer"),e=this.$n.find("div.table-pager");u.html(i.injector.exec("tableBody"));f.html(i.injector.exec("footerTable"));e.html(i.injector.exec("pagerBar"));n.helpers.sortStyle(t);(t.fixedheaders||t.fixedfooters)&&(r=this.$n.find(".table-body > table > tbody > tr:first-child > td"),n.hasPositiveWidth(r)&&(i.syncColumnWidths(t),i.syncColumnWidths(t)),window.addEventListener("resize",function(){i.syncColumnWidths(t)}))}catch(o){n.error(o)}},syncColumnWidths:function(){var n=this.injector.exec("columnWidthStyle");this.$n.find("style.column-width-style").html(n)},resolveFooter:function(n){for(var t=0;t<n.columns.length;t++)if(n.columns[t].footertemplate)return!0;return!1},resolveTopLevelOptions:function(t){var i,r="rowselected searchfunction read create update destroy validate model".split(" ");r.forEach(function(r){n.hasValue(t[r])&&(i=n.getObjectAtPath(t[r]),n.hasValue(i)&&(t[r]=i))})},resolveTemplates:function(t,i,r){var e,u,o,f=$(r),s='script[type="text/html"][data-template*="{{name}}"],template[data-template*="{{name}}"]';t.forEach(function(t){if(e=n.supplant(s,{name:t}),u=f.find(e),u.length)for(var r=0;r<f[0].children.length;r++)if(f[0].children[r]==u[0]){o=n.camelize(t)+"template";i[o]=u[0].innerHTML;return}})},compileTemplates:function(t){["headertemplate","bodytemplate","edittemplate","footertemplate"].forEach(function(i){t.columns.forEach(function(t){t[i]&&(t[i]=new n.Template(t[i]))})})},resolveCommands:function(t){var i,r;t.columns.forEach(function(t){typeof t.commands=="string"&&(r=[],t.commands.split(",").forEach(function(n){i=n.split(":");r.push({text:i[0],value:i[1],btnClass:i[2],glyphicon:i[3]})}),t.commands=r);Array.isArray(t.commands)&&t.commands.forEach(function(t){t.text=t.text||t.value;t.value=t.value||t.text;t.btnClass=t.btnClass||(/delete|destroy/i.test(t.text)?"btn-danger":"btn-default");t.glyphicon=t.glyphicon||(/delete|destroy/i.test(t.text)?"glyphicon-remove":/edit/i.test(t.text)?"glyphicon-edit":"glyphicon-cog");t.func=t.func||n.getObjectAtPath(t.value)})})}};n.Injector=function(n,t,i,r){this.resources=n;n.$injector=this;this.root=t||window;this.context=i||this;this.overrides=r||{}};n.Injector.prototype={setResource:function(n,t){return this.resources[n]=t,this},base:function(n,t){return this.exec(n,t,!0)},exec:function(t,i,r){var u;return typeof t=="string"&&(t=r?n.getObjectAtPath(t,this.root):n.getObjectAtPath(t,this.overrides)||n.getObjectAtPath(t,this.root)),typeof t=="function"?(u=this.inject(t),n.hasValue(i)&&u.push(i),t.apply(this.context,u)):n.supplant.call(this.context,t,this.resources)},inject:function(n){var t=this,i,r=[];return i=n.$inject?n.$inject:this.getParamNames(n),i.forEach(function(n){if(t.resources.hasOwnProperty(n))r.push(t.resources[n]);else if(n[0]==="$")throw"Unrecognized dependency: "+n;}),r},getParamNames:function(n){var t=n.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,""),i=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g);return i===null&&(i=[]),i}},function(n){var t,i;n.Http=function(){};t={read:/read/i,update:/update/i,create:/create/i,destroy:/Delete/i};n.Http.prototype={post:function(r,u,f){if(u=u||{},t.read.test(r))i(u,f);else if(t.create.test(r))window.data.products.push(u),f(new n.UpdateModel(u));else if(t.update.test(r))f(new n.UpdateModel(u));else throw"404 Not found: "+r;},destroy:function(n,t){t({Success:!0,Message:""})}};i=function(t,i){var e,r=window.data.products.slice(0,window.data.length),u,f;n.isNullOrEmpty(t.search)||(u=Object.getOwnPropertyNames(r[0]),f=t.search.toLowerCase(),r=r.filter(function(n){for(var t=0;t<u.length;t++)if(n[u[t]]&&n[u[t]].toString().toLowerCase().indexOf(f)!==-1)return!0;return!1}));n.isNullOrEmpty(t.sort)||(t.desc?r.sort(function(n,i){var u=n[t.sort],r=i[t.sort];if(u===null){if(r!=null)return 1}else if(r===null)return-1;return u>r?-1:u<r?1:0}):r.sort(function(n,i){var u=n[t.sort],r=i[t.sort];if(u===null){if(r!=null)return-1}else if(r===null)return 1;return u>r?1:u<r?-1:0}));e=r.length;t.data=t.top!==-1?r.slice(t.skip).slice(0,t.top):r;t.errors=[];setTimeout(function(){i(t)})}}(gridponent);n.ModelSync={rexp:{rTrue:/^true$/i,rFalse:/^false$/i},serialize:function(n){var i=$(n).find(":input[name]"),r,t={};return i.each(function(){t[this.name]=null}),r=$(i).serializeArray(),r.forEach(function(n){t[n.name]===null||Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]);Array.isArray(t[n.name])?t[n.name].push(n.value):t[n.name]=n.value}),t},bindElements:function(n,t){var r=this,i;Object.getOwnPropertyNames(n).forEach(function(u){i=n[u];Array.isArray(i)?i.forEach(function(n){r.bindElement(u,n,t)}):r.bindElement(u,i,t)})},bindElement:function(t,i,r){var e=this,o,u,f;if(i=n.hasValue(i)?i.toString():"",u=$(r).find('[type=checkbox][name="'+t+'"],[type=radio][name="'+t+'"]'),u.length>0)for(o=n.escapeHTML(i),f=0;f<u.length;f++)if(u[f].value==i||u[f].value==o){u[f].checked=!0;return}if(/^(true|false)$/i.test(i)&&(u=$(r).find('[type=checkbox][name="'+t+'"][value=true],[type=checkbox][name="'+t+'"][value=false]'),u.length>0)){u.each(function(n){this.checked=e.rexp.rTrue.test(i)&&e.rexp.rTrue.test(n.value)||e.rexp.rFalse.test(i)&&e.rexp.rFalse.test(n.value)});return}u=$(r).find('[name="'+t+'"]');u.length>0&&(u[0].value!==undefined?u.val(i):u[0].innerHTML!==undefined&&u.html(i==null?"":n.escapeHTML(i)))},castValues:function(t,i){var r;Object.getOwnPropertyNames(t).forEach(function(u){r=n.getColumnByField(i,u);r&&r.Type&&(t[u]=this.cast(t[u],r.Type))}.bind(this))},cast:function(n,t){switch(t){case"number":if($.isNumeric(n))return parseFloat(n);break;case"boolean":return n!=null&&n.toLowerCase()=="true";case"null":case"undefined":return/true|false/i.test(n)?n!=null&&n.toLowerCase()=="true":n===""?null:n;default:return n===""?null:n}}};n.NodeBuilder=function(n){this.node=n||null};n.NodeBuilder.prototype={create:function(n){var t=document.createElement(n);return this.node&&this.node.appendChild(t),this.node=t,this},addClass:function(t){if(n.isNullOrEmpty(t))return this;var i=(" "+this.node.className+" ").indexOf(" "+t+" ")!==-1;return i||(this.node.className=this.node.className===""?t:this.node.className+" "+t),this},html:function(t){return this.node.innerHTML=n.hasValue(t)?t:"",this},endElem:function(){return this.node.parentElement&&(this.node=this.node.parentElement),this},attr:function(n,t){return this.node.setAttribute(n,t),this},close:function(){while(this.node.parentElement)this.node=this.node.parentElement;return this.node}};n.ServerPager=function(n){this.url=n};n.ServerPager.prototype={read:function(t,i,r){var u=n.shallowCopy(t),o=Object.getOwnPropertyNames(u).forEach(function(n){/^(page|top|sort|desc|search)$/i.test(n)==!1&&delete u[n]}),f=n.supplant(this.url,t,t),e=new n.Http;e.post(f,u,i,r)}};n.ClientPager=function(t){var i,r=this;this.data=t.pageModel.data;this.columns=t.columns.filter(function(n){return n.field!==undefined||n.sort!==undefined});this.searchFilter=typeof t.searchfunction=="function"?t.searchfunction:function(t,u){for(var e=u.toLowerCase(),f=0;f<r.columns.length;f++)if(i=n.getFormattedValue(t,r.columns[f],!1),n.hasValue(i)&&i.toString().toLowerCase().indexOf(e)!==-1)return!0;return!1}};n.ClientPager.prototype={read:function(t,i){var u,f,e,r,o;try{u=this;e=this.getSkip(t);t.data=this.data.slice(0,this.data.length);n.isNullOrEmpty(t.search)||(f=$.trim(t.search.toString()),t.data=t.data.filter(function(n){return u.searchFilter(n,f)}));t.totalrows=t.data.length;t.pagecount=this.getPageCount(t);n.isNullOrEmpty(t.sort)===!1&&(r=n.getColumnByField(this.columns,t.sort),n.hasValue(r)&&(o=this.getSortFunction(r,t.desc),t.data.sort(function(n,i){return o(n[t.sort],i[t.sort])})));t.top!==-1&&(t.data=t.data.slice(e).slice(0,t.top))}catch(s){n.error(s)}i(t)},getSkip:function(n){var t=n;if(t.pagecount==0)return 0;if(t.page<1)t.page=1;else if(t.page>t.pagecount)return t.page=t.pagecount;return(t.page-1)*t.top},getPageCount:function(n){return n.top>0?Math.ceil(n.totalrows/n.top):n.totalrows===0?0:1},getSortFunction:function(n,t){return/^(number|date|boolean)$/.test(n.Type)?t?this.diffSortDesc:this.diffSortAsc:t?this.stringSortDesc:this.stringSortAsc},diffSortDesc:function(n,t){return t-n},diffSortAsc:function(n,t){return n-t},stringSortDesc:function(t,i){return n.hasValue(t)===!1?n.hasValue(i)?1:0:n.hasValue(i)===!1?-1:t.toString().toLowerCase()>i.toString().toLowerCase()?-1:t.toString().toLowerCase()<i.toString().toLowerCase()?1:0},stringSortAsc:function(t,i){return n.hasValue(t)===!1?n.hasValue(i)?-1:0:n.hasValue(i)===!1?1:t.toString().toLowerCase()>i.toString().toLowerCase()?1:t.toString().toLowerCase()<i.toString().toLowerCase()?-1:0}};n.FunctionPager=function(n){this.config=n};n.FunctionPager.prototype={read:function(t,i,r){try{var e=this,u=this.config.read(t,i.bind(this));n.hasValue(u)&&i(u)}catch(f){typeof r=="function"?n.applyFunc(r,this,f):n.applyFunc(i,this,this.config);n.error(f)}}};n.PagingModel=function(n){var t=this;this.top=-1;this.page=1;this.sort="";this.desc=!1;this.search="";this.data=n||[];this.totalrows=n!=undefined&&n.length?n.length:0;this.pagecount=0;Object.defineProperty(t,"pageindex",{get:function(){return t.page-1}});Object.defineProperty(t,"skip",{get:function(){if(t.top!==-1){if(t.pagecount===0)return 0;if(t.page<1)t.page=1;else if(t.page>t.pagecount)return t.page=t.pagecount;return t.pageindex*t.top}return 0}})};n.StringBuilder=function(){this.out=[]};n.StringBuilder.prototype={add:function(n){return this.out.push(n),this},escape:function(t){return this.out.push(n.escapeHTML(t)),this},toString:function(){return this.out.join("")}};n.Template=function(n){this.template=n;this.dict={};this.props=null;this.compile(n)};n.Template.prototype={rRaw:/({{{([^{}]*)}}})/g,rEsc:/({{([^{}]*)}})(?:$|[^}])/g,r3Braces:/^{{{/,rTypes:/^(string|number|boolean)$/,compile:function(){if(typeof this.template=="string"){for(var n;(n=this.rRaw.exec(this.template))!==null;)this.resolveToken(n[1],n[2]);while((n=this.rEsc.exec(this.template))!==null)this.resolveToken(n[1],n[2]);this.props=Object.getOwnPropertyNames(this.dict)}},resolveToken:function(t,i){var r=n.getObjectAtPath(i);this.dict[t]=typeof r=="function"?r:i},render:function(t,i){var u=this,e=this.template,f,r;return typeof this.template=="function"?n.applyFunc(this.template,u,[t,i]):(this.props.forEach(function(o){f=u.dict[o];typeof f=="function"?r=n.applyFunc(f,u,[t,i]):(r=t[f],typeof r=="function"&&(r=n.applyFunc(r,u,[t,i])));u.r3Braces.test(o)===!1&&(r=n.escapeHTML(r));e=u.replaceAll(e,o,r)}),e)},replaceAll:function(t,i,r){return r=n.hasValue(r)?r:"",t.split(i).join(r)}};n.templates=n.templates||{};n.templates.bodyCellContent=function(t,i,r){var o=this,f,e=(t.Type||"").toLowerCase(),u=new n.StringBuilder;if(i!=null)return f=n.getFormattedValue(i,t,!0),t.bodytemplate?typeof t.bodytemplate=="function"?u.add(n.applyFunc(t.bodytemplate,this,[i,t])):u.add(n.supplant.call(this,t.bodytemplate,i,[i,t])):t.commands&&t.commands.length?(u.add('<div class="btn-group btn-group-xs" role="group">'),t.commands.forEach(function(n){u.add(r.exec("button",n))}),u.add("<\/div>")):n.hasValue(f)&&(e==="boolean"?f===!0&&u.add('<span class="glyphicon glyphicon-ok"><\/span>'):u.add(f)),u.toString()};n.templates.bodyCellContent.$inject=["$column","$dataItem","$injector"];n.templates.bootstrapModal=function(t){t.footer=t.footer||'<div class="btn-group"><button type="button" class="btn btn-default" value="cancel"><span class="glyphicon glyphicon-remove"><\/span>Close<\/button><button type="button" class="btn btn-primary" value="save"><span class="glyphicon glyphicon-save"><\/span>Save changes<\/button><\/div>';var i=new n.StringBuilder;return i.add('<div class="modal fade" tabindex="-1" role="dialog" data-uid="{{uid}}">').add('<div class="modal-dialog" role="document">').add('<div class="modal-content">').add('<div class="modal-header">').add('<button type="button" class="close" aria-label="Close" value="cancel"><span aria-hidden="true">&times;<\/span><\/button>').add('<h4 class="modal-title">{{title}}<\/h4>').add("<\/div>").add('<div class="modal-body">{{{body}}}<\/div>').add('<div class="modal-footer">{{{footer}}}<\/div>').add("<\/div>").add('<div class="gp-progress-overlay">').add('<div class="gp-progress gp-progress-container">').add('<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><\/div>').add("<\/div>").add("<\/div>").add("<\/div>").add("<\/div>"),n.supplant.call(this,i.toString(),t)};n.templates.bootstrapModalContent=function(t,i,r,u){var o=this,e={title:r=="create"?"Add":"Edit",body:"",footer:null,uid:t.map.getUid(i)},f=new n.StringBuilder;return f.add('<div class="form-horizontal">'),t.columns.forEach(function(t){var r,i;if(u.setResource("$column",t),t.commands){e.footer=u.exec("editCellContent");return}(r=!t.readonly&&(n.hasValue(t.field)||n.hasValue(t.edittemplate)),r)&&(i={label:null,input:u.exec("editCellContent"),editclass:t.editclass},i.label=t.headertemplate?typeof t.headertemplate=="function"?n.applyFunc(t.headertemplate,o,[t]):n.supplant.call(o,t.headertemplate,[t]):n.escapeHTML(n.coalesce([t.header,t.field,""])),f.add(u.exec("formGroup",i)))}),f.add("<\/div>"),e.body=f.toString(),u.exec("bootstrapModal",e)};n.templates.bootstrapModalContent.$inject=["$config","$dataItem","$mode","$injector"];n.templates.button=function(t){return n.supplant.call(this,'<button type="button" class="btn {{btnClass}}" value="{{value}}"><span class="glyphicon {{glyphicon}}"><\/span>{{text}}<\/button>',t)};n.templates.columnWidthStyle=function(t,i){var u=new n.StringBuilder,e,r=0,f=document.querySelectorAll("#"+t.ID+" .table-body > table > tbody > tr:first-child > td");return i.forEach(function(n){n.width?(u.add("#"+t.ID+" .table-header th.header-cell:nth-child("+(r+1)+"),").add("#"+t.ID+" .table-footer td.footer-cell:nth-child("+(r+1)+")").add(",").add("#"+t.ID+" > .table-body > table > thead th:nth-child("+(r+1)+"),").add("#"+t.ID+" > .table-body > table > tbody td:nth-child("+(r+1)+")").add("{ width:").add(n.width),isNaN(n.width)==!1&&u.add("px"),u.add(";}")):f.length&&(t.fixedheaders||t.fixedfooters)&&(e=f[r].offsetWidth,u.add("#"+t.ID+" .table-header th.header-cell:nth-child("+(r+1)+"),").add("#"+t.ID+" .table-footer td.footer-cell:nth-child("+(r+1)+")").add("{ width:").add(f[r].offsetWidth).add("px;}"));r++}),u.toString()};n.templates.columnWidthStyle.$inject=["$config","$columns"];n.templates.container=function(t,i){var r=new n.StringBuilder;return r.add('<div class="gp table-container ').add(i.exec("containerClasses")).add('" id="').add(t.ID).add('">'),(t.search||t.create||t.toolbartemplate)&&(r.add('<div class="table-toolbar">'),r.add(i.exec("toolbartemplate")),r.add("<\/div>")),t.fixedheaders&&r.add('<div class="table-header">').add('<table class="table" cellpadding="0" cellspacing="0">').add(i.exec("header")).add("<\/table>").add("<\/div>"),r.add('<div class="table-body '),t.fixedheaders&&r.add("table-scroll"),r.add('">').add('<table class="table" cellpadding="0" cellspacing="0"><tbody><\/tbody><\/table>').add("<\/div>"),t.fixedfooters&&r.add('<div class="table-footer"><\/div>'),t.pager&&r.add('<div class="table-pager"><\/div>'),r.add('<style type="text/css" class="column-width-style">').add(i.exec("columnWidthStyle")).add("<\/style>").add('<div class="gp-progress-overlay">').add('<div class="gp-progress gp-progress-container">').add('<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><\/div>').add("<\/div>").add("<\/div>").add("<\/div>"),r.toString()};n.templates.container.$inject=["$config","$injector"];n.templates.containerClasses=function(n){var t=[];return n.fixedheaders&&t.push("fixed-headers"),n.fixedfooters&&t.push("fixed-footers"),n.pager&&t.push("pager-"+n.pager),n.responsive&&t.push("table-responsive"),n.search&&t.push("search-"+n.search),n.rowselected&&t.push("selectable"),n.containerclass&&t.push(n.containerclass),t.join(" ")};n.templates.containerClasses.$inject=["$config"];n.templates.editCellContent=function(t,i,r,u,f){var e=t,o=new n.StringBuilder,s;return e.edittemplate?typeof e.edittemplate=="function"?o.add(n.applyFunc(e.edittemplate,this,[i,e])):o.add(n.supplant.call(this,e.edittemplate,i,[i,e])):e.commands?o.add('<div class="btn-group').add(u.editmode=="inline"?" btn-group-xs":"").add('">').add(f.exec("button",{btnClass:"btn-primary",value:r=="create"?"create":"update",glyphicon:"glyphicon-save",text:"Save"})).add('<button type="button" class="btn btn-default" data-dismiss="modal" value="cancel">').add('<span class="glyphicon glyphicon-remove"><\/span>Cancel').add("<\/button>").add("<\/div>"):(s=i[e.field],n.hasValue(s)||(s=""),o.add(f.exec("input",{type:e.Type,name:e.field,value:""}))),o.toString()};n.templates.editCellContent.$inject=["$column","$dataItem","$mode","$config","$injector"];n.templates.footer=function(t,i){var u=this,r=new n.StringBuilder;return r.add("<tfoot>").add("<tr>"),t.forEach(function(n){i.setResource("$column",n);r.add(i.exec("footerCell"))}),r.add("<\/tr>").add("<\/tfoot>"),r.toString()};n.templates.footer.$inject=["$columns","$injector"];n.templates.footerCell=function(t){var i=new n.StringBuilder;return i.add('<td class="footer-cell">').add(t.exec("footerCellContent")).add("<\/td>"),i.toString()};n.templates.footerCell.$inject=["$injector"];n.templates.footerCellContent=function(t,i){var r=new n.StringBuilder;return i.footertemplate&&(typeof i.footertemplate=="function"?r.add(n.applyFunc(i.footertemplate,this,[i,t])):r.add(n.supplant.call(this,i.footertemplate,i,[i,t]))),r.toString()};n.templates.footerCellContent.$inject=["$data","$column"];n.templates.footerTable=function(t){var i=new n.StringBuilder;return i.add('<table class="table" cellpadding="0" cellspacing="0">').add(t.exec("footer")).add("<\/table>"),i.toString()};n.templates.footerTable.$inject=["$injector"];n.templates.formGroup=function(t){return n.supplant.call(this,'<div class="form-group {{editclass}}"><label class="col-sm-4 control-label">{{{label}}}<\/label><div class="col-sm-6">{{{input}}}<\/div><\/div>',t)};n.templates.input=function(t){var i={type:t.type=="boolean"?"checkbox":t.type=="number"?"number":"text",name:t.name,value:t.type=="boolean"?"true":t.type=="date"?n.formatter.format(t.value,"YYYY-MM-DD"):n.escapeHTML(t.value),checked:t.type=="boolean"&&t.value?" checked":"",dataType:/^date/.test(t.type)?' data-type="date"':""};return n.supplant.call(this,'<input type="{{type}}" name="{{name}}" value="{{value}}" class="form-control"{{{dataType}}}{{checked}} />',i)};n.templates.pagerBar=function(t){var i=n.shallowCopy(t),r=new n.StringBuilder;return i.IsFirstPage=i.page===1,i.IsLastPage=i.page===i.pagecount,i.HasPages=i.pagecount>1,i.PreviousPage=i.page===1?1:i.page-1,i.NextPage=i.page===i.pagecount?i.pagecount:i.page+1,i.firstPageClass=i.IsFirstPage?"disabled":"",i.lastPageClass=i.IsLastPage?"disabled":"",i.HasPages&&r.add('<div class="btn-group">').add('<button class="ms-page-index btn btn-default {{firstPageClass}}" title="First page" value="page" data-page="1">').add('<span class="glyphicon glyphicon-triangle-left" aria-hidden="true"><\/span>').add("<\/button>").add('<button class="ms-page-index btn btn-default {{firstPageClass}}" title="Previous page" value="page" data-page="{{PreviousPage}}">').add('<span class="glyphicon glyphicon-menu-left" aria-hidden="true"><\/span>').add("<\/button>").add("<\/div>").add('<input type="number" name="page" value="{{page}}" class="form-control" style="width:75px;display:inline-block;vertical-align:middle" />').add('<span class="page-count"> of {{pagecount}}<\/span>').add('<div class="btn-group">').add('<button class="ms-page-index btn btn-default {{lastPageClass}}" title="Next page" value="page" data-page="{{NextPage}}">').add('<span class="glyphicon glyphicon-menu-right" aria-hidden="true"><\/span>').add("<\/button>").add('<button class="ms-page-index btn btn-default {{lastPageClass}}" title="Last page" value="page" data-page="{{pagecount}}">').add('<span class="glyphicon glyphicon-triangle-right" aria-hidden="true"><\/span>').add("<\/button>").add("<\/div>"),n.supplant.call(this,r.toString(),i)};n.templates.pagerBar.$inject=["$pageModel"];n.templates.tableBody=function(t,i){var r=new n.StringBuilder;return r.add('<table class="table" cellpadding="0" cellspacing="0">'),t.fixedheaders||r.add(i.exec("header")),r.add("<tbody>").add(i.exec("tableRows")).add("<\/tbody>"),t.hasFooter&&!t.fixedfooters&&r.add(i.exec("footer")),r.add("<\/table>"),r.toString()};n.templates.tableBody.$inject=["$config","$injector"];n.templates.tableRow=function(t,i){var u=this,r=new n.StringBuilder;return r.add('<tr data-uid="').add(i).add('">').add(t.exec("tableRowCells")).add("<\/tr>"),r.toString()};n.templates.tableRow.$inject=["$injector"];n.templates.tableRowCell=function(t,i){var u=this,r=new n.StringBuilder;return i.setResource("$column",t),r.add('<td class="body-cell '),t.commands&&r.add("commands "),r.add(t.bodyclass).add('">').add(i.exec("bodyCellContent")).add("<\/td>"),r.toString()};n.templates.tableRowCell.$inject=["$column","$injector"];n.templates.tableRowCells=function(t,i){var u=this,r=new n.StringBuilder;return t.forEach(function(n){i.setResource("$column",n);r.add(i.exec("tableRowCell"))}),r.toString()};n.templates.tableRowCells.$inject=["$columns","$injector"];n.templates.tableRows=function(t,i,r){var e=this,u=new n.StringBuilder,f;return(i||(i=new n.DataMap,r.setResource("$map",i)),t==null)?"":(t.forEach(function(n){r.setResource("$dataItem",n);f=i.assign(n);u.add(r.exec("tableRow",f))}),u.toString())};n.templates.tableRows.$inject=["$data","$map","$injector"];n.templates.header=function(t,i,r){var u=new n.StringBuilder;return u.add("<thead><tr>"),t.forEach(function(n){u.add(r.setResource("$column",n).exec("headerCell"))}),u.add("<\/tr><\/thead>"),u.toString()};n.templates.header.$inject=["$columns","$config","$injector"];n.templates.headerCell=function(t,i,r){var e=this,u=new n.StringBuilder,f="";return i.sorting?f=n.escapeHTML(n.coalesce([t.sort,t.field])):n.hasValue(t.sort)&&(f=n.escapeHTML(t.sort)),u.add('<th class="header-cell '+(t.headerclass||"")+'"'),n.hasValue(f)&&u.add(' data-sort="'+f+'"'),u.add(">"),u.add(r.exec("headerCellContent")),u.add("<\/th>"),u.toString()};n.templates.headerCell.$inject=["$column","$config","$injector"];n.templates.headerCellContent=function(t,i){var f=this,r=new n.StringBuilder,u="";return i.sorting?u=n.escapeHTML(n.coalesce([t.sort,t.field])):n.hasValue(t.sort)&&(u=n.escapeHTML(t.sort)),t.headertemplate?typeof t.headertemplate=="function"?r.add(n.applyFunc(t.headertemplate,f,[t])):r.add(n.supplant.call(f,t.headertemplate,t,[t])):n.isNullOrEmpty(u)?r.escape(n.coalesce([t.header,t.field,""])):r.add('<a href="javascript:void(0);" class="table-sort" value="sort" data-sort="').escape(u).add('">').escape(n.coalesce([t.header,t.field,u])).add('<span class="glyphicon"><\/span>').add("<\/a>"),r.toString()};n.templates.headerCellContent.$inject=["$column","$config"];n.templates.toolbartemplate=function(t,i){var r=new n.StringBuilder;return t.search&&r.add('<div class="input-group gridponent-searchbox">').add('<input type="text" name="search" class="form-control" placeholder="Search...">').add('<span class="input-group-btn">').add(i.exec("button",{btnClass:"btn-default",value:"search",glyphicon:"glyphicon-search"})).add("<\/span>").add("<\/div>"),t.create&&r.add(i.exec("button",{btnClass:"btn-default",value:"AddRow",glyphicon:"glyphicon-plus",text:"Add"})),r.toString()};n.templates.toolbartemplate.$inject=["$config","$injector"];n.UpdateModel=function(t,i){this.dataItem=t;this.errors=i;this.original=n.shallowCopy(t)},function(n){var u,f;n.applyFunc=function(t,i,r,u){if(typeof t=="function")try{return r==undefined?t.call(i):(r=Array.isArray(r)?r:[r],t.apply(i,r))}catch(f){u=u||n.error;n.applyFunc(u,i,f)}};n.camelize=function(t){return n.isNullOrEmpty(t)?t:t.replace(/[A-Z]([A-Z]+)/g,function(n,t){return n?n.substr(0,1)+t.toLowerCase():""}).replace(/[-_](\w)/g,function(n,t){return t?t.toUpperCase():""}).replace(/^([A-Z])/,function(n,t){return t?t.toLowerCase():""})};n.coalesce=function(t){if(n.isNullOrEmpty(t))return t;for(var i=0;i<t.length;i++)if(n.hasValue(t[i]))return t[i];return t[t.length-1]};var t=Function.prototype,i=t.bind?t.bind.bind(t.call):function(n){return function(t){return function(){return n.apply(t,arguments)}}}(t.call),r={},e=i("".slice),o=i(0..toString);n.createUID=function(){var n="gp"+e(o(Math.random(),36),2);return n in r?createUID():r[n]=n};n.disable=function(t,i){$(t).attr("disabled","disabled").addClass("disabled busy");typeof i=="number"&&i>0&&setTimeout(function(){n.enable(t)},i*1e3)};n.enable=function(n){$(n).removeAttr("disabled").removeClass("disabled busy")};u=[/&/g,/</g,/>/g,/"/g,/'/g,/`/g];f=["&amp;","&lt;","&gt;","&quot;","&apos;","&#96;"];n.escapeHTML=function(n){return typeof n!="string"?n:(u.forEach(function(t,i){n=n.replace(t,f[i])}),n)};n.formatter=new n.Formatter;n.getAttributes=function(t){for(var u={},f,i,e=$(t)[0].attributes,r=e.length-1;r>=0;r--)i=e[r],f=i.name.toLowerCase().replace("-",""),u[f]=n.rexp.trueFalse.test(i.value)||i.value===""?i.value==="true"||i.value==="":i.value;return u};n.getColumnByField=function(n,t){var i=n.filter(function(n){return n.field===t||n.sort===t});return i.length?i[0]:null};n.getCommand=function(n,t){var i=[],r;return n.forEach(function(n){Array.isArray(n.commands)&&(i=i.concat(n.commands))}),r=i.filter(function(n){return n.value===t}),r.length>0?r[0]:void 0};n.getDefaultValue=function(n){switch(n){case"number":return 0;case"boolean":return!1;case"date":default:return null}};n.getFormattedValue=function(t,i,r){var f=(i.Type||"").toLowerCase(),u=f==="function"?i.field(t):t[i.field];return/^(date|datestring|timestamp)$/.test(f)?n.formatter.format(u,i.format):/^(number|function)$/.test(f)&&i.format?n.formatter.format(u,i.format):f===""&&i.format&&/^(?:\d*\.)?\d+$/.test(u)?n.formatter.format(parseFloat(u),i.format):f==="string"&&r?n.escapeHTML(u):u};n.getObjectAtPath=function(t,i){var u,r,f;if(typeof t!="string")return t;for(u=i||window,t=t.match(n.rexp.splitPath),t[0]==="window"&&(t=t.splice(1)),f=0;f<t.length;f++)if(r=t[f],n.rexp.indexer.test(r)?r=parseInt(/\d+/.exec(r)):n.rexp.quoted.test(r)&&(r=r.slice(1,-1)),u=u[r],u===undefined)return;return u};n.getTableRow=function(n,t,i){var r=n.getUid(t);if(r!=-1)return $(i).find('tr[data-uid="'+r+'"]')};n.getType=function(t){if(t===null||t===undefined)return t;if(t instanceof Date)return"date";if(typeof t=="string"){if(n.rexp.iso8601.test(t))return"datestring";if(n.rexp.timestamp.test(t))return"timestamp"}return Array.isArray(t)?"array":typeof t};n.hasPositiveWidth=function(t){if(n.isNullOrEmpty(t))return!1;for(var i=0;i<t.length;i++)if(t[i].offsetWidth>0)return!0;return!1};n.hasValue=function(n){return n!==undefined&&n!==null};n.isNullOrEmpty=function(t){return n.hasValue(t)===!1||t.length!=undefined&&t.length===0};n.resolveTypes=function(t){var i,r,u=t&&t.pageModel&&t.pageModel.data&&t.pageModel.data.length;t.columns.forEach(function(f){if(!n.hasValue(f.Type)&&(i=n.hasValue(f.field)?f.field:f.sort,!n.isNullOrEmpty(i))){if(typeof i=="function"){f.Type="function";return}if(t.model&&n.hasValue(t.model[i])&&(f.Type=n.getType(t.model[i])),!n.hasValue(f.Type)&&u)for(var e=0;e<t.pageModel.data.length&&e<25;e++)if(r=t.pageModel.data[e][i],r!==null){f.Type=n.getType(r);break}}})};n.rexp={splitPath:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/,iso8601:/^[012][0-9]{3}-[01][0-9]-[0123][0-9]/,timestamp:/\/Date\((\d+)\)\//,quoted:/^['"].+['"]$/,trueFalse:/true|false/i,json:/^\{.*\}$|^\[.*\]$/,copyable:/^(object|date|array|function)$/};n.shallowCopy=function(t,i,r){if(i=i||{},!n.rexp.copyable.test(n.getType(t)))return i;var f,u,e=Object.getOwnPropertyNames(t);return e.forEach(function(e){(u=r?n.camelize(e):e,!i.hasOwnProperty(e)||(f=Object.getOwnPropertyDescriptor(i,e),f.writable))&&(i[u]=typeof t[e]=="function"?t[e]():t[e])}),i};n.supplant=function(t,i,r){var f=this,e=/^(string|number|boolean)$/,u;return t=t.replace(/{{{([^{}]*)}}}/g,function(t,o){return(u=n.getObjectAtPath(o,i),e.test(typeof u))?u:typeof u=="function"?n.applyFunc(u,f,r):(u=n.getObjectAtPath(o),typeof u=="function"?n.applyFunc(u,f,r):"")}),t.replace(/{{([^{}]*)}}/g,function(t,o){return(u=n.getObjectAtPath(o,i),e.test(typeof u))?n.escapeHTML(u):typeof u=="function"?n.escapeHTML(n.applyFunc(u,f,r)):(u=n.getObjectAtPath(o),typeof u=="function"?n.escapeHTML(n.applyFunc(u,f,r)):"")})};n.log=window.console?window.console.log.bind(window.console):function(){};n.error=function(n){console&&console.error&&console.error(n)}}(gridponent);document.registerElement?(n.Gridponent=Object.create(HTMLElement.prototype),n.Gridponent.createdCallback=function(){var t=new n.Initializer(this);$(t.initialize.bind(t))},n.Gridponent.detachedCallback=function(){var n=this.querySelector(".table-container");n&&n.api&&n.api.dispose()},document.registerElement("grid-ponent",{prototype:n.Gridponent})):(n.initialize=function(t){var r,i;for(t=$(t||document)[0],r=t.querySelectorAll("grid-ponent"),i=0;i<r.length;i++)new n.Initializer(r[i]).initialize()},$(function(){n.initialize()}))})(gridponent);