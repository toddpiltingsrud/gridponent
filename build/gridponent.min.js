/*! gridponent 2018-05-30 */
var gridponent=gridponent||function(a,b){"use strict";if("string"==typeof a&&(a=document.querySelector(a)),a instanceof HTMLElement){var c=a.querySelector(".table-container");if(c&&c.api)return c.api;var d=new gridponent.Initializer(a),e=d.initializeOptions(b);return e.node.api}throw new Error("Could not resolve selector: "+a.toString())};!function(a){"use strict";a.events={rowSelected:"rowselected",beforeInit:"beforeinit",beforeRead:"beforeread",beforeEdit:"beforeedit",onRead:"onread",onEdit:"onedit",editReady:"editready",httpError:"httpError",ready:"ready"},a.api=function(a){this.controller=a,this.config=a.config,this.$n=$(this.config.node)},a.api.prototype={create:function(a){return this.controller.addRow(a),this},destroy:function(a,b){return this.controller.deleteRow(a,b,!0),this},dispose:function(){return this.controller.dispose(),this},find:function(a){return this.$n.find(a).addBack(a)},getData:function(a){return void 0!=a?this.config.map.get(a):this.controller.config.requestModel.Data},getTableRow:function(b){return a.getTableRow(this.controller.config.map,b,this.controller.config.node)},read:function(a,b){return this.controller.read(a,b),this},refresh:function(a){return this.controller.read(null,a),this},saveChanges:function(a,b){return this.controller.updateRow(a,b),this},search:function(b,c){return b=a.isNullOrEmpty(b)?"":b.toString(),this.controller.search(b,c),this},sort:function(b,c,d){return b=a.isNullOrEmpty(b)?"":b.toString(),c="boolean"==typeof c?c:"false"!==c&&!!c,this.controller.sort(b,c,d),this},toggleBusy:function(a){return a=a===!0||a===!1?a:!this.$n.hasClass("busy"),a?this.$n.addClass("busy"):this.$n.removeClass("busy"),this}},Object.getOwnPropertyNames(a.events).forEach(function(b){a.api.prototype[b]=function(c){return"function"==typeof c&&this.controller.addDelegate(a.events[b],c),this}}),a.api.prototype.ready=function(a){return this.controller.ready(a),this},a.api.prototype.rowSelected=function(b){return"function"==typeof b&&(this.controller.addDelegate(a.events.rowSelected,b),this.$n.addClass("selectable")),this},a.Controller=function(a,b,c,d){this.config=a,this.model=b,this.$n=$(a.node),this.requestModel=c,this.injector=d,this.pollInterval=null,a.pager&&(this.requestModel.pageSize=25),this.handlers={readHandler:this.read.bind(this),commandHandler:this.commandHandler.bind(this),rowSelectHandler:this.rowSelectHandler.bind(this),httpErrorHandler:this.httpErrorHandler.bind(this),toolbarChangeHandler:this.toolbarChangeHandler.bind(this),toolbarEnterKeyHandler:this.toolbarEnterKeyHandler.bind(this),resizeHandler:this.resizeHandler.bind(this)},this.done=!1,this.eventDelegates={},this.addBusyDelegates()},a.Controller.prototype={init:function(){var b=this;this.addCommandHandlers(this.config.node),this.addRowSelectHandler(this.config),this.addRefreshEventHandler(this.config),this.addToolbarChangeHandler(),this.addResizeHandler(),this.config.preload?this.read(this.config.requestModel,function(){b.handlePolling(b.config),b.done=!0,b.invokeDelegates(a.events.ready,b.config.node.api)}):(this.handlePolling(this.config),this.done=!0,this.invokeDelegates(a.events.ready,this.config.node.api))},addResizeHandler:function(){(this.config.fixedheaders||this.config.fixedfooters)&&window.addEventListener("resize",this.handlers.resizeHandler)},removeResizeHandler:function(){(this.config.fixedheaders||this.config.fixedfooters)&&window.removeEventListener("resize",this.handlers.resizeHandler)},resizeHandler:function(){var a=this.injector.exec("columnWidthStyle");this.$n.find("style.column-width-style").html(a)},addBusyDelegates:function(){this.addDelegate(a.events.beforeRead,this.addBusy),this.addDelegate(a.events.onRead,this.removeBusy),this.addDelegate(a.events.beforeEdit,this.addBusy),this.addDelegate(a.events.onEdit,this.refreshFooter),this.addDelegate(a.events.onEdit,this.removeBusy),this.addDelegate(a.events.httpError,this.removeBusy)},addBusy:function(){this.$n.addClass("busy")},removeBusy:function(){this.$n.removeClass("busy")},ready:function(b){this.done?a.applyFunc(b,this.config.node.api,this.config.node.api):this.addDelegate(a.events.ready,b)},addDelegate:function(a,b){this.eventDelegates[a]=this.eventDelegates[a]||[],this.eventDelegates[a].push(b)},invokeDelegates:function(b,c){var d=this,e=!0,f=this.eventDelegates[b];return Array.isArray(f)&&f.forEach(function(b){e!==!1&&(e=a.applyFunc(b,d.config.node.api,c))}),a.triggerEvent(this.$n,"gp-"+b),e},addToolbarChangeHandler:function(){var a=".table-toolbar [name], thead input, .table-pager input";this.$n.on("change",a,this.handlers.toolbarChangeHandler),this.$n.on("keydown",a,this.handlers.toolbarEnterKeyHandler)},removeToolbarChangeHandler:function(){this.$n.off("change",this.handlers.toolbarChangeHandler),this.$n.off("keydown",this.handlers.toolbarEnterKeyHandler)},toolbarEnterKeyHandler:function(a){if(13==a.keyCode)return void a.target.blur()},toolbarChangeHandler:function(b){var c=b.target.name,d=this.config.requestModel,e=a.getType(d[c]),f=a.ModelSync.cast(b.target.value,e);d[c]=f,this.read()},addCommandHandlers:function(a){$(a).on("click","button[value],a[value]",this.handlers.commandHandler)},removeCommandHandlers:function(a){$(a).off("click",this.handlers.commandHandler)},commandHandler:function(b){var c,d=$(b.currentTarget),e=d.closest("[data-uid],div.modal",this.config.node),f=e.length?this.config.map.get(e[0]):null,g=d.attr("value"),h=a.getCommand(this.config.columns,g),i=this.config.requestModel;if(h&&"function"==typeof h.func)return void h.func.call(this.config.node.api,f);switch(c=(g||"").toLowerCase()){case"addrow":this.addRow();break;case"edit":this.editRow(f,e);break;case"delete":case"destroy":this.deleteRow(f,e);break;case"page":var j=d.attr("data-page");i.page=parseInt(j),this.read();break;case"search":i.search=this.$n.find(".table-toolbar input[name=search]").val(),this.read();break;case"sort":var k=d.attr("data-sort");i.sort===k?i.desc=!i.desc:(i.sort=k,i.desc=!1),this.read();break;default:h=a.getObjectAtPath(g),"function"==typeof h&&h.call(this.config.node.api,f)}},getEditor:function(b){var c,d=this;return c=void 0==b?new a.Editor(this.config,this.model,this.injector):"modal"==b?new a.ModalEditor(this.config,this.model,this.injector):new a.TableRowEditor(this.config,this.model,this.injector),c.beforeEdit=function(b){d.invokeDelegates(a.events.beforeEdit,b)},c.afterEdit=function(b){d.invokeDelegates(a.events.onEdit,b)},c.editReady=function(b){d.invokeDelegates(a.events.editReady,b)},c},addRowSelectHandler:function(a){this.$n.on("click","div.table-body > table > tbody > tr:not(.update-mode,.create-mode) > td.body-cell",this.handlers.rowSelectHandler)},removeRowSelectHandler:function(){this.$n.off("click",this.handlers.rowSelectHandler)},rowSelectHandler:function(b){var c,d,e=this.config,f=$(b.target).closest("tr",e.node),g=this.$n.find("div.table-body > table > tbody > tr.selected"),h=typeof e.rowselected;$(b.target).closest("a,:input,:button,:submit",e.node).length>0||("string"===h&&e.rowselected.indexOf("{{")!==-1&&(h="urlTemplate"),g.removeClass("selected").attr("aria-selected","false"),$(f).addClass("selected").attr("aria-selected","true"),c=e.map.get(f),d=this.invokeDelegates(a.events.rowSelected,c),d!==!1&&"urlTemplate"===h&&(window.location=a.supplant.call(this.config.node.api,e.rowselected,c)))},addRefreshEventHandler:function(a){a.refreshevent&&$(document).on(a.refreshevent,this.handlers.readHandler)},removeRefreshEventHandler:function(a){a.refreshevent&&$(document).off(a.refreshevent,this.handlers.readHandler)},search:function(a,b){this.config.requestModel.search=a,this.$n.find("div.table-toolbar input[name=search]").val(a),this.read(null,b)},sort:function(a,b,c){this.config.requestModel.sort=a,this.config.requestModel.desc=1==b,this.read(null,c)},read:function(b,c){var d=this,e=!0;b&&a.shallowCopy(b,this.config.requestModel),e=this.invokeDelegates(a.events.beforeRead,this.config.requestModel),e!==!1&&this.model.read(this.config.requestModel,function(b){try{a.shallowCopy(b,d.config.requestModel),d.injector.setResource("$data",d.config.requestModel.Data),d.injector.setResource("$requestModel",d.config.requestModel),d.injector.setResource("$mode","read"),d.config.map.clear(),a.resolveTypes(d.config),d.refresh(d.config),d.invokeDelegates(a.events.onRead,d.config.requestModel),a.applyFunc(c,d.config.node,d.config.requestModel)}catch(e){d.removeBusy(),d.httpErrorHandler(e)}},this.handlers.httpErrorHandler)},handlePolling:function(a){if($.isNumeric(a.poll)&&!(a.poll<=0)){var b=this;this.pollInterval=setInterval(function(){var c=a.node.ownerDocument.body.contains(a.node);c?b.read(a.requestModel):(clearInterval(b.pollInterval),b.pollInterval=null)},1e3*a.poll)}},addRow:function(a){var b=this.getEditor(this.config.editmode);b.add(a);return b},editRow:function(a,b){var c=this.getEditor(this.config.editmode);c.edit(a,b);return c},updateRow:function(b,c){try{var d,e=this,f=this.getEditor();if(!a.hasValue(this.config.update))return void a.applyFunc(c,e.config.node);f.edit(b),f.save(function(f){d=a.getTableRow(e.config.map,b,e.$n[0]),d&&e.refresh(),"function"==typeof c&&a.applyFunc(c,e,f)},this.httpErrorHandler.bind(this))}catch(g){this.removeBusy(),this.httpErrorHandler(g)}},deleteRow:function(b,c,d){try{if(!a.hasValue(this.config.destroy))return void a.applyFunc(c,this.config.node);var e=this,f=d||confirm("Are you sure you want to delete this item?"),g=a.getTableRow(this.config.map,b,this.$n[0]);if(!f)return void a.applyFunc(c,this.config.node);this.invokeDelegates(a.events.beforeEdit,{type:"destroy",dataItem:b,elem:g}),this.model.destroy(b,function(d){try{if(!d||!d.errors){var f=e.config.requestModel.Data.indexOf(b);f!=-1&&e.config.requestModel.Data.splice(f,1),e.refresh(e.config)}}catch(h){a.error(h)}e.invokeDelegates(a.events.onEdit,{type:"destroy",dataItem:b,elem:g,response:d}),a.applyFunc(c,e.config.node.api,d)},e.handlers.httpErrorHandler)}catch(h){this.removeBusy(),this.httpErrorHandler(h)}},refresh:function(){try{var b=this.$n.find("div.table-body"),c=this.$n.find("div.table-footer"),d=this.$n.find("div.table-pager"),e=this.$n.find("style.sort-style");this.config.map.clear(),b.html(this.injector.exec("tableBody")),c.html(this.injector.exec("footerTable")),d.html(this.injector.exec("pagerBar")),e.html(this.injector.exec("sortStyle")),a.hasValue(this.config.nodatatext)&&(this.$n.removeClass("nodata"),this.injector.resources.$data&&0!=this.injector.resources.$data.length||this.$n.addClass("nodata"))}catch(f){a.error(f)}},refreshFooter:function(b){if(/^(create|update)$/.test(b.type))try{var c=this.$n.find("tfoot");if(c.length){var d=$(this.controller.injector.exec("footer")).find("tr");c.html(d)}}catch(e){a.error(e)}},httpErrorHandler:function(b){this.invokeDelegates(a.events.httpError,b),alert("An error occurred while carrying out your request."),a.error(b)},dispose:function(){this.removeRefreshEventHandler(this.config),this.removeRowSelectHandler(),this.removeCommandHandlers(this.config.node),this.removeToolbarChangeHandler(),this.removeResizeHandler(),this.pollInterval&&clearInterval(this.pollInterval)}},function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}return"function"!=typeof window.CustomEvent&&(a.prototype=window.Event.prototype,void(window.CustomEvent=a))}(),a.DataLayer=function(a){this.config=a,this.reader=null},a.DataLayer.prototype={getReader:function(){var b=a.getType(this.config.read);switch(b){case"string":return new a.ServerPager(this.config.read);case"function":return new a.FunctionPager(this.config);case"object":if(a["implements"](this.config.read,a.RequestModel.prototype)){var c=new a.RequestModel;return a.shallowCopy(this.config.read,c),this.config.requestModel=c,new a.ClientPager(this.config)}throw"Unsupported read configuration";case"array":return this.config.requestModel.Data=this.config.read,new a.ClientPager(this.config);default:throw"Unsupported read configuration"}},read:function(b,c,d){var e=this;this.reader||(this.reader=this.getReader()),this.reader.read(b,function(b){b=e.resolveResult(b),a.applyFunc(c,e,[b])},function(b){a.applyFunc(d,e,[b])})},create:function(b,c,d){var e,f=this;if("function"==typeof this.config.create)a.applyFunc(this.config.create,this.config.node.api,[b,c,d],d);else{e=a.supplant(this.config.create,b);var g=new a.Http;g.post(e,b,function(b){a.applyFunc(c,f,b)},function(b){a.applyFunc(d,f,b)})}},update:function(b,c,d){var e,f=this;if("function"==typeof this.config.update)a.applyFunc(this.config.update,this.config.node.api,[b,c,d],d);else{e=a.supplant(this.config.update,b);var g=new a.Http;g.post(e,b,function(b){a.applyFunc(c,f,b)},function(b){a.applyFunc(d,f,b)})}},destroy:function(b,c,d){var e,f=this;if("function"==typeof this.config.destroy)a.applyFunc(this.config.destroy,this.config.node.api,[b,c,d],d);else{e=a.supplant(this.config.destroy,b);var g=new a.Http;g.destroy(e,function(b){a.applyFunc(c,f,b)},function(b){a.applyFunc(d,f,b)})}},resolveResult:function(b){return a.hasValue(b)&&Array.isArray(b)?new a.RequestModel(b):b}},a.DataMap=function(){this.uid=0,this.map={}},a.DataMap.prototype={assign:function(a){var b=++this.uid;return this.map[b]=a,b},get:function(a){var b=this.resolveUid(a);return this.map[b]},getUid:function(a){for(var b,c=Object.getOwnPropertyNames(this.map),d=0;d<c.length;d++)if(b=c[d],this.map[b]===a)return b;return-1},resolveUid:function(a){var b=-1;return $.isNumeric(a)?b=parseInt(a):(a=$(a).closest("[data-uid]"),1===a.length&&(b=parseInt($(a).attr("data-uid")))),isNaN(b)?-1:b},remove:function(a){var b=this.resolveUid(a);b in this.map&&delete this.map[b]},clear:function(){this.uid=0,this.map={}}},a.Editor=function(a,b,c){this.config=a,this.dal=b,this.uid=null,this.dataItem=null,this.originalDataItem=null,this.mode=null,this.beforeEdit=null,this.afterEdit=null,this.editReady=null,this.button=null,this.$n=$(a.node),this.injector=c},a.Editor.prototype={add:function(a){return this.dataItem=a||this.createDataItem(),this.mode="create",this.injector.setResource("$dataItem",this.dataItem).setResource("$mode",this.mode),this.config.requestModel.Data.push(this.dataItem),this.uid=this.config.map.assign(this.dataItem),{dataItem:this.dataItem,uid:this.uid}},edit:function(b){return this.dataItem=b,this.mode="update",this.setInjectorContext(),this.originalDataItem=a.shallowCopy(b),{dataItem:b}},cancel:function(){if(this.setInjectorContext(),"create"===this.mode){this.config.map.remove(this.uid);var b=this.config.requestModel.Data.indexOf(this.dataItem);b!==-1&&this.config.requestModel.Data.slice(b,1)}else"update"==this.mode&&this.originalDataItem&&a.shallowCopy(this.originalDataItem,this.dataItem);this.removeCommandHandler()},httpErrorHandler:function(b){alert("An error occurred while carrying out your request."),a.error(b)},save:function(b,c){var d,e=this,c=c||a.error;this.setInjectorContext(),this.addBusy(),this.elem&&(d=a.ModelSync.serialize(this.elem),a.ModelSync.castValues(d,this.config.columns),a.shallowCopy(d,this.dataItem)),"function"==typeof this.beforeEdit&&this.beforeEdit({type:this.mode,dataItem:this.dataItem,originalDataItem:this.originalDataItem,elem:this.elem}),"create"==this.mode?this.dal.create(this.dataItem,function(a){e.handleResponse(a,b,c)},function(b){e.removeBusy(),a.applyFunc(c,e,b)}):this.dal.update(this.dataItem,function(a){e.handleResponse(a,b,c)},function(b){e.removeBusy(),a.applyFunc(c,e,b)})},handleResponse:function(b,c,d){var e;try{this.injector.setResource("$mode",null),e=a.resolveResponseModel(b,this.dataItem),a.hasValue(e.errors)?this.validate(e):(a.shallowCopy(e.dataItem,this.dataItem),this.elem&&(this.updateUI(this.config,this.dataItem,this.elem),this.removeCommandHandler&&this.removeCommandHandler()))}catch(f){var g=d||a.error;g(f)}this.button instanceof HTMLElement&&a.enable(this.button),this.removeBusy(),"function"==typeof this.afterEdit&&this.afterEdit({type:this.mode,dataItem:this.dataItem,originalDataItem:this.originalDataItem,elem:this.elem,response:e}),a.applyFunc(c,this.config.node.api,e)},addBusy:function(){this.$n.addClass("busy")},removeBusy:function(){this.$n.removeClass("busy")},updateUI:function(){},validate:function(){},createDataItem:function(){var b,c={};return this.config.columns.forEach(function(d){b=d.field||d.sort,a.hasValue(b)&&(a.hasValue(d.Type)?c[b]=a.getDefaultValue(d.Type):c[b]="")}),"object"==typeof this.config.model&&a.shallowCopy(this.config.model,c),c},setInjectorContext:function(){this.injector.setResource("$dataItem",this.dataItem).setResource("$mode",this.mode)}},a.TableRowEditor=function(b,c,d){var e=this;a.Editor.call(this,b,c,d),this.elem=null,this.commandHandler=function(b){var c=$(this).val();/^(create|update|save)$/i.test(c)?(e.button=b.target,a.disable(e.button,5),e.save(null,e.httpErrorHandler)):/^cancel$/i.test(c)&&e.cancel()}},a.TableRowEditor.prototype=Object.create(a.Editor.prototype),$.extend(a.TableRowEditor.prototype,{addCommandHandler:function(){$(this.elem).on("click","button[value]",this.commandHandler)},removeCommandHandler:function(){$(this.elem).off("click",this.commandHandler)},add:function(b){var c=this.$n.find("div.table-body > table > tbody"),d=a.Editor.prototype.add.call(this,b);return this.elem=$(this.injector.exec("tableRow",d.uid)),a.ModelSync.bindElements(this.dataItem,this.elem),this.addCommandHandler(),"top"===this.config.newrowposition?c.prepend(this.elem):c.append(this.elem),"function"==typeof this.elem[0].scrollIntoView&&this.elem[0].scrollIntoView(),this.invokeEditReady(),this.injector.setResource("$mode",null),{dataItem:this.dataItem,elem:this.elem}},edit:function(b,c){var d;return a.Editor.prototype.edit.call(this,b),this.elem=c,this.addCommandHandler(),d=this.injector.exec("tableRowCells"),$(c).addClass("update-mode").empty().append(d),a.ModelSync.bindElements(b,this.elem),this.invokeEditReady(),this.injector.setResource("$mode",null),{dataItem:b,elem:this.elem}},cancel:function(){a.Editor.prototype.cancel.call(this);try{$(this.elem).closest("table",this.$n);$(this.elem).hasClass("create-mode")?$(this.elem).remove():this.updateUI()}catch(b){a.error(b)}},validate:function(b){if("function"==typeof this.config.validate)a.applyFunc(this.config.validate,this,[this.elem,b]);else{var c,d=this,e=new a.StringBuilder;e.add("Please correct the following errors:\r\n"),$(d.elem).find("[name].error").removeClass("error"),Object.getOwnPropertyNames(b.errors).forEach(function(a){$(d.elem).find('[name="'+a+'"]').addClass("error"),c=b.errors[a].errors,e.add(a+":\r\n").add(c.map(function(a){return"    - "+a+"\r\n"}).join(""))}),alert(e.toString())}},updateUI:function(){var a;this.injector.setResource("$mode","read"),a=this.injector.exec("tableRowCells"),$(this.elem).removeClass("update-mode create-mode").empty().append(a)},invokeEditReady:function(){"function"==typeof this.editReady&&this.editReady({dataItem:this.dataItem,elem:this.elem})}}),a.ModalEditor=function(b,c,d){a.TableRowEditor.call(this,b,c,d)},a.ModalEditor.prototype=Object.create(a.Editor.prototype),$.extend(a.ModalEditor.prototype,{addCommandHandler:a.TableRowEditor.prototype.addCommandHandler,removeCommandHandler:a.TableRowEditor.prototype.removeCommandHandler,validate:a.TableRowEditor.prototype.validate,invokeEditReady:a.TableRowEditor.prototype.invokeEditReady,add:function(b){var c,d,e=this;return a.Editor.prototype.add.call(this,b),c=this.injector.exec("bootstrapModal"),d=$(c).appendTo(this.config.node).one("shown.bs.modal",function(){e.addCommandHandler(),e.invokeEditReady()}),this.elem=d[0],d.modal({show:!0,keyboard:!0,backdrop:"static"}),a.ModelSync.bindElements(this.dataItem,this.elem),d.one("hidden.bs.modal",function(){$(d).remove()}),{dataItem:this.dataItem,elem:this.elem}},edit:function(b){var c,d,e=this;return a.Editor.prototype.edit.call(this,b),c=this.injector.exec("bootstrapModal"),d=$(c).appendTo(this.config.node).one("shown.bs.modal",e.invokeEditReady.bind(e)),this.elem=d[0],d.modal({show:!0,keyboard:!0,backdrop:"static"}),a.ModelSync.bindElements(b,this.elem),d.one("hidden.bs.modal",function(){$(d).remove()}),this.addCommandHandler(),{dataItem:b,elem:this.elem}},cancel:function(){a.Editor.prototype.cancel.call(this),$(this.elem).modal("hide")},updateUI:function(){var b,c,d,e;$(this.elem).modal("hide"),d=this.injector.exec("tableRow",this.uid),"create"==this.mode?(b=this.$n.find("div.table-body > table > tbody"),"top"===this.config.newrowposition?b.prepend(d):b.append(d)):(c=a.getTableRow(this.config.map,this.dataItem,this.config.node),e=$(d).find("td.body-cell"),$(c).empty().append(e))}}),a.Http=function(){},a.Http.prototype={get:function(a,b,c){$.get(a).done(b).fail(c)},post:function(a,b,c,d){this.ajax(a,b,c,d,"POST")},destroy:function(a,b,c){this.ajax(a,null,b,c,"DELETE")},ajax:function(a,b,c,d,e){$.ajax({url:a,type:e.toUpperCase(),data:b,contentType:"application/x-www-form-urlencoded; charset=UTF-8"}).done(c).fail(function(a){if(a.status){if(200==a.status)return void c(a);0==/401|403|407/.test(a.status)&&"function"==typeof d&&d(a)}})}},a.Initializer=function(a){this.parent=$(a)},a.Initializer.prototype={initialize:function(a){return this.config=this.getConfig(this.parent),this.initializeOptions(this.config,a)},initializeOptions:function(b,c){var d=this;b.requestModel={},b.ID=a.createUID(),this.config=b,this.config.map=new a.DataMap,this.config.requestModel=a["implements"](this.config.read,a.RequestModel.prototype)?new a.RequestModel(this.config.read):new a.RequestModel,this.config.editmode=this.config.editmode||"inline",this.config.newrowposition=this.config.newrowposition||"top",this.injector=new a.Injector({$config:this.config,$columns:this.config.columns,$node:this.config.node,$requestModel:this.config.requestModel,$map:this.config.map,$data:this.config.requestModel.Data,$mode:"read"},a.templates,null,this.config),this.resolveCustomResource(this.config,this.injector),this.renderLayout(this.config,this.parent),this.config.node=this.parent.find(".table-container")[0],this.$n=this.parent.find(".table-container");var e=new a.DataLayer(this.config),f=new a.Controller(this.config,e,this.config.requestModel,this.injector);return this.config.node.api=new a.api(f),this.config.hasFooter=this.resolveFooter(this.config),this.config.preload=this.config.preload!==!1||this.config.preload,this.injector.context=this.config.node.api,setTimeout(function(){d.resolveTopLevelOptions(d.config),d.syncToolbar(d.config),d.addEventDelegates(d.config,f),f.invokeDelegates(a.events.beforeInit,d.config),a.resolveTypes(d.config),d.resolveCommands(d.config),f.init()}),this.config},getConfig:function(b){var c,d,e=this,f=a.getAttributes(b),g=$(b).find("gp-column");return f.columns=[],d="header body edit footer".split(" "),g.each(function(){c=a.getAttributes(this),f.columns.push(c),e.resolveTemplates(d,c,this,"template")}),this.resolveTemplates(Object.getOwnPropertyNames(a.templates),f,b,""),f},addEventDelegates:function(b,c){var d,e;b.node.api;Object.getOwnPropertyNames(a.events).forEach(function(f){d=a.events[f],e=b[d],"string"==typeof e&&(e=a.getObjectAtPath(e)),"function"==typeof e&&(b[d]=e,c.addDelegate(d,e))})},renderLayout:function(b,c){try{$(c).html(this.injector.exec("container"))}catch(d){a.error(d)}},syncToolbar:function(b){try{var c=b.node.api.find("div.table-toolbar");if(a["implements"](b.read,a.RequestModel.prototype))a.ModelSync.bindElements(b.read,c);else{var d=a.ModelSync.serialize(c);a.ModelSync.castModel(d,a.RequestModel.prototype),a.shallowCopy(d,b.requestModel)}}catch(e){a.error(e)}},resolveFooter:function(a){for(var b=0;b<a.columns.length;b++)if(a.columns[b].footertemplate)return!0;return!1},resolveTopLevelOptions:function(b){var c,d="rowselected searchfunction read create update destroy validate model".split(" ");d.forEach(function(d){a.hasValue(b[d])&&(c=a.getObjectAtPath(b[d]),a.hasValue(c)&&(b[d]=c))})},resolveTemplates:function(b,c,d,e){var f,g,h,i=$(d),j='script[type="text/html"][data-template~="{{name}}"],template[data-template~="{{name}}"]';b.forEach(function(b){if(f=a.supplant(j,{name:b}),g=i.find(f),g.length)for(var d=0;d<i[0].children.length;d++)if(i[0].children[d]==g[0])return h=b+e,void(c[h]=g[0].innerHTML)})},resolveCommands:function(b){var c,d;b.columns.forEach(function(b){"string"==typeof b.commands&&(d=[],b.commands.split(",").forEach(function(a){c=a.split(":"),d.push({text:c[0],value:c[1],btnClass:c[2],glyphicon:c[3]})}),b.commands=d),Array.isArray(b.commands)&&b.commands.forEach(function(b){b.text=b.text||b.value,b.value=b.value||b.text,b.btnClass=b.btnClass||(/delete|destroy/i.test(b.text)?"btn-danger":"btn-default"),b.glyphicon=b.glyphicon||(/delete|destroy/i.test(b.text)?"glyphicon-remove":/edit/i.test(b.text)?"glyphicon-edit":"glyphicon-cog"),b.func=b.func||a.getObjectAtPath(b.value)})})},resolveCustomResource:function(b,c){if(b.inject&&"string"==typeof b.inject){var d=b.inject.match(a.rexp.splitPath);c.setResource(d[d.length-1],a.getObjectAtPath(b.inject))}}},a.Injector=function(a,b,c,d){this.resources=a,a.$injector=this,a.$window=window,this.root=b||window,this.context=c||this,this.overrides=d||{}},a.Injector.prototype={setResource:function(a,b){return this.resources[a]=b,this},base:function(a,b){return this.exec(a,b,!0)},exec:function(b,c,d){var e;return"string"==typeof b&&(b=d?this.root[b]:this.overrides[b]||this.root[b]),"function"==typeof b?(e=this.inject(b),a.hasValue(c)&&e.push(c),b.apply(this.context,e)):a.supplant.call(this.context,b,this.resources,this.resources)},inject:function(a){var b,c=this,d=[];return b=a.$inject?a.$inject:this.getParamNames(a),b.forEach(function(a){if(c.resources.hasOwnProperty(a))d.push(c.resources[a]);else if("$"===a[0])throw"Unrecognized dependency: "+a}),d},getParamNames:function(a){var b=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,c=/([^\s,]+)/g,d=a.toString().replace(b,""),e=d.slice(d.indexOf("(")+1,d.indexOf(")")).match(c);return null===e&&(e=[]),e}},a.ModelSync={rexp:{rTrue:/^true$/i,rFalse:/^false$/i},serialize:function(a){var b,c=$(a).find(":input[name]"),d={};return c.each(function(){d[this.name]=null}),b=$(c).serializeArray(),b.forEach(function(a){null===d[a.name]||Array.isArray(d[a.name])||(d[a.name]=[d[a.name]]),Array.isArray(d[a.name])?d[a.name].push(a.value):d[a.name]=a.value}),d},bindElements:function(a,b){var c,d=this;Object.getOwnPropertyNames(a).forEach(function(e){c=a[e],Array.isArray(c)?c.forEach(function(a){d.bindElement(e,a,b)}):d.bindElement(e,c,b)})},bindElement:function(b,c,d){var e,f,g=this;if(c=a.hasValue(c)?c.toString():"",f=$(d).find('[type=checkbox][name="'+b+'"],[type=radio][name="'+b+'"]'),f.length>0){e=a.escapeHTML(c);for(var h=0;h<f.length;h++)if(f[h].value==c||f[h].value==e)return void(f[h].checked=!0)}else{if(/^(true|false)$/i.test(c)&&(f=$(d).find('[type=checkbox][name="'+b+'"][value=true],[type=checkbox][name="'+b+'"][value=false]').add('[type=radio][name="'+b+'"][value=true],[type=radio][name="'+b+'"][value=false]'),f.length>0))return void f.each(function(a){this.checked=g.rexp.rTrue.test(c)&&g.rexp.rTrue.test(a.value)||g.rexp.rFalse.test(c)&&g.rexp.rFalse.test(a.value)});f=$(d).find('[name="'+b+'"]'),f.length>0&&(void 0!==f[0].value?f.val(c):void 0!==f[0].innerHTML&&f.html(null==c?"":a.escapeHTML(c)))}},castValues:function(b,c){var d;Object.getOwnPropertyNames(b).forEach(function(e){d=a.getColumnByField(c,e),d&&d.Type&&(b[e]=this.cast(b[e],d.Type))}.bind(this))},castModel:function(b,c){var d,e,f=this,g=Object.getOwnPropertyNames(b);g.forEach(function(g){c.hasOwnProperty(g)&&(d=a.getType(c[g]),d&&(e=b[g],b[g]=f.cast(e,d)))})},cast:function(a,b){switch(b){case"number":if($.isNumeric(a))return parseFloat(a);break;case"boolean":return null!=a&&"true"==a.toLowerCase();case null:case void 0:return/true|false/i.test(a)?null!=a&&"true"==a.toLowerCase():""===a?null:a;default:return""===a?null:a}}},a.ServerPager=function(a){this.url=a},a.ServerPager.prototype={read:function(b,c,d){var e=a.shallowCopy(b),f=(Object.getOwnPropertyNames(e).forEach(function(a){0==/^(page|top|sort|desc|search)$/i.test(a)&&delete e[a]}),a.supplant(this.url,b,b)),g=new a.Http;g.post(f,e,c,d)}},a.ClientPager=function(b){var c,d=this;this.Data=b.requestModel.Data,this.columns=b.columns.filter(function(a){return void 0!==a.field||void 0!==a.sort}),"function"==typeof b.searchfunction?this.searchFilter=b.searchfunction:this.searchFilter=function(b,e){for(var f=e.toLowerCase(),g=0;g<d.columns.length;g++)if(c=a.getFormattedValue(b,d.columns[g],!1),a.hasValue(c)&&c.toString().toLowerCase().indexOf(f)!==-1)return!0;return!1}},a.ClientPager.prototype={read:function(b,c,d){try{var e,f=this,g=this.getSkip(b);if(b.Data=this.Data.slice(0,this.Data.length),a.isNullOrEmpty(b.search)||(e=$.trim(b.search.toString()),b.Data=b.Data.filter(function(a){return f.searchFilter(a,e)})),b.total=b.Data.length,a.isNullOrEmpty(b.sort)===!1){var h=a.getColumnByField(this.columns,b.sort);if(a.hasValue(h)){var i=this.getSortFunction(h,b.desc);b.Data.sort(function(a,c){return i(a[b.sort],c[b.sort])})}}b.pageSize!==-1&&(b.Data=b.Data.slice(g).slice(0,b.pageSize))}catch(j){a.error(j)}c(b)},getSkip:function(a){var b=a;if(0==b.PageCount)return 0;if(b.page<1)b.page=1;else if(b.page>b.PageCount)return b.page=b.PageCount;return(b.page-1)*b.pageSize},getSortFunction:function(a,b){return/^(number|date|boolean)$/.test(a.Type)?b?this.diffSortDesc:this.diffSortAsc:b?this.stringSortDesc:this.stringSortAsc},diffSortDesc:function(a,b){return b-a},diffSortAsc:function(a,b){return a-b},stringSortDesc:function(b,c){return a.hasValue(b)===!1?a.hasValue(c)?1:0:a.hasValue(c)===!1?-1:b.toString().toLowerCase()>c.toString().toLowerCase()?-1:b.toString().toLowerCase()<c.toString().toLowerCase()?1:0},stringSortAsc:function(b,c){return a.hasValue(b)===!1?a.hasValue(c)?-1:0:a.hasValue(c)===!1?1:b.toString().toLowerCase()>c.toString().toLowerCase()?1:b.toString().toLowerCase()<c.toString().toLowerCase()?-1:0}},a.FunctionPager=function(a){this.config=a},a.FunctionPager.prototype={read:function(b,c,d){try{var e=this.config.read(b,c.bind(this));a.hasValue(e)&&c(e)}catch(f){"function"==typeof d?a.applyFunc(d,this,f):a.applyFunc(c,this,this.config),a.error(f)}}},a.RequestModel=function(b){var c=this;this.pageSize=-1,this.page=1,this.sort="",this.desc=!1,this.search="","object"==a.getType(b)?a.shallowCopy(b,this):this.Data=b||[],this.total=void 0!=b&&b.length?b.length:0,Object.defineProperty(c,"pageindex",{get:function(){return c.page-1}}),Object.defineProperty(c,"skip",{get:function(){if(c.pageSize!==-1){if(0===c.PageCount)return 0;if(c.page<1)c.page=1;else if(c.page>c.PageCount)return c.page=c.PageCount;return c.pageindex*c.pageSize}return 0}}),Object.defineProperty(c,"PageCount",{get:function(){return c.pageSize>0?Math.ceil(c.total/c.pageSize):0===c.total?0:1}})},a.RequestModel.prototype={pageSize:-1,page:1,sort:"",desc:!1,search:"",Data:[],total:0},a.ResponseModel=function(a,b){this.DataItem=a,this.Errors=b},a.StringBuilder=function(){this.out=[]},a.StringBuilder.prototype={add:function(a){return this.out.push(a),this},addFormat:function(b,c){return Array.isArray(c)||(c=[c]),this.out.push(a.supplant(b,c)),this},escape:function(b){return this.out.push(a.escapeHTML(b)),this},toString:function(){return this.out.join("")}},a.templates=a.templates||{},a.templates.bodyCellContent=function(b,c,d){var e,f=(b.Type||"").toLowerCase(),g=new a.StringBuilder;if(null!=c)return e=a.getFormattedValue(c,b,!0),b.bodytemplate?"function"==typeof b.bodytemplate?g.add(a.applyFunc(b.bodytemplate,this,[c,b])):g.add(a.supplant.call(this,b.bodytemplate,c,[c,b])):b.commands&&b.commands.length?(g.add('<div class="btn-group btn-group-xs" role="group">'),b.commands.forEach(function(a,b){g.add(d.exec("button",a))}),g.add("</div>")):a.hasValue(e)&&("boolean"===f?e===!0&&g.add('<span class="glyphicon glyphicon-ok"></span>'):g.add(e)),g.toString()},a.templates.bodyCellContent.$inject=["$column","$dataItem","$injector"],a.templates.bootstrapModal=function(b,c,d,e){var f="create"==e?"Add":"Edit",g=b.map.getUid(c),h=new a.StringBuilder;
return h.addFormat('<div class="modal fade" tabindex="-1" role="dialog" data-uid="{{0}}">',g).add('<div class="modal-dialog" role="document">').add('<div class="modal-content">').add('<div class="modal-header">').add('<button type="button" class="close" aria-label="Close" value="cancel"><span aria-hidden="true">&times;</span></button>').addFormat('<h4 class="modal-title">{{0}}</h4>',f).add("</div>").add('<div class="modal-body">').add(d.exec("bootstrapModalBody")).add("</div>").add('<div class="modal-footer">').add(d.exec("bootstrapModalFooter")).add("</div>").add("</div>").add('<div class="gp-progress-overlay">').add('<div class="gp-progress gp-progress-container">').add('<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>').add("</div>").add("</div>").add("</div>").add("</div>"),h.toString()},a.templates.bootstrapModal.$inject=["$config","$dataItem","$injector","$mode"],a.templates.bootstrapModalBody=function(b,c){var d=this,e=new a.StringBuilder;return e.add('<div class="form-horizontal">'),b.columns.forEach(function(b){c.setResource("$column",b);var f=!b.readonly&&(a.hasValue(b.field)||a.hasValue(b.edittemplate));if(f){var g={label:null,input:c.exec("editCellContent"),editclass:b.editclass};b.headertemplate?"function"==typeof b.headertemplate?g.label=a.applyFunc(b.headertemplate,d,[b]):g.label=a.supplant.call(d,b.headertemplate,[b]):g.label=a.escapeHTML(a.coalesce([b.header,b.field,""])),e.add(c.exec("formGroup",g))}}),e.add("</div>"),e.toString()},a.templates.bootstrapModalBody.$inject=["$config","$injector"],a.templates.bootstrapModalFooter=function(a,b){var c=a.filter(function(a){return a.commands});return c.length?(b.setResource("$column",c[0]),b.exec("editCellContent")):'<div class="btn-group"><button type="button" class="btn btn-default" value="cancel"><span class="glyphicon glyphicon-remove"></span>Close</button><button type="button" class="btn btn-primary" value="save"><span class="glyphicon glyphicon-save"></span>Save changes</button></div>'},a.templates.bootstrapModalFooter.$inject=["$columns","$injector"],a.templates.button=function(b){var c='<button type="button" class="btn {{btnClass}}" value="{{value}}"><span class="glyphicon {{glyphicon}}"></span>{{text}}</button>';return a.supplant.call(this,c,b)},a.templates.columnWidthStyle=function(b,c){var d,e=new a.StringBuilder,f=0,g=document.querySelectorAll("#"+b.ID+" .table-body > table > tbody > tr:first-child > td"),h="#{{0}} .table-header th.header-cell:nth-child({{1}}),#{{0}} .table-footer td.footer-cell:nth-child({{1}}),#{{0}} > .table-body > table > thead th:nth-child({{1}}),#{{0}} > .table-body > table > tbody td:nth-child({{1}}){ width:{{2}}{{3}}; }",i="#{{0}} .table-header th.header-cell:nth-child({{1}}),#{{0}} .table-footer td.footer-cell:nth-child({{1}}){ width:{{2}}px; }";return c.forEach(function(a){a.width?(d=0==isNaN(a.width)?"px":"",e.addFormat(h,[b.ID,f+1,a.width,d])):g.length&&(b.fixedheaders||b.fixedfooters)&&e.addFormat(i,[b.ID,f+1,g[f].offsetWidth]),f++}),e.toString()},a.templates.columnWidthStyle.$inject=["$config","$columns"],a.templates.container=function(b,c){var d=new a.StringBuilder;return d.addFormat('<div class="gp table-container {{0}}" id="{{1}}">',[c.exec("containerClasses"),b.ID]),(b.search||b.create||b.toolbar)&&(d.add('<div class="table-toolbar">'),d.add(c.exec("toolbar")),d.add("</div>")),b.fixedheaders&&d.add('<div class="table-header">').add('<table class="table">').add(c.exec("header")).add("</table>").add("</div>"),d.addFormat('<div class="table-body{{0}}">',b.fixedheaders?" table-scroll":"").add('<table class="table" cellpadding="0" cellspacing="0"><tbody></tbody></table>').add("</div>"),b.fixedfooters&&d.add('<div class="table-footer"></div>'),b.pager&&d.add('<div class="table-pager"></div>'),d.add('<style type="text/css" class="column-width-style">').add(c.exec("columnWidthStyle")).add("</style>").add('<style type="text/css" class="sort-style"></style>').addFormat('<div class="gp-nodatatext">{{0}}</div>',b.nodatatext).add('<div class="gp-progress-overlay">').add('<div class="gp-progress gp-progress-container">').add('<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>').add("</div>").add("</div>").add("</div>"),d.toString()},a.templates.container.$inject=["$config","$injector"],a.templates.containerClasses=function(a){var b=[];return a.fixedheaders===!0&&b.push("fixed-headers"),"string"==typeof a.fixedheaders&&a.fixedheaders.split(" ").forEach(function(a){b.push("fixed-headers-"+a)}),a.fixedfooters&&b.push("fixed-footers"),a.pager&&b.push("pager-"+a.pager),a.responsive&&b.push("table-responsive"),a.search&&b.push("search-"+a.search),a.rowselected&&b.push("selectable"),a.containerclass&&b.push(a.containerclass),b.join(" ")},a.templates.containerClasses.$inject=["$config"],a.templates.editCellContent=function(b,c,d,e,f){var g=b,h=new a.StringBuilder;if(g.edittemplate)"function"==typeof g.edittemplate?h.add(a.applyFunc(g.edittemplate,this,[c,g])):h.add(a.supplant.call(this,g.edittemplate,c,[c,g]));else if(g.commands)h.add('<div class="btn-group').add("inline"==e.editmode?" btn-group-xs":"").add('">').add(f.exec("button",{btnClass:"btn-primary",value:"create"==d?"create":"update",glyphicon:"glyphicon-save",text:"Save"})).add('<button type="button" class="btn btn-default" data-dismiss="modal" value="cancel">').add('<span class="glyphicon glyphicon-remove"></span>Cancel').add("</button>").add("</div>");else{var i=c[g.field];a.hasValue(i)||(i=""),h.add(f.exec("input",{type:g.Type,name:g.field,value:"",required:b.required||!1}))}return h.toString()},a.templates.editCellContent.$inject=["$column","$dataItem","$mode","$config","$injector"],a.templates.footer=function(b,c){var d=new a.StringBuilder;return d.add("<tfoot>").add("<tr>"),b.forEach(function(a){c.setResource("$column",a),d.add(c.exec("footerCell"))}),d.add("</tr>").add("</tfoot>"),d.toString()},a.templates.footer.$inject=["$columns","$injector"],a.templates.footerCell=function(b,c){var d=new a.StringBuilder;return d.addFormat('<td class="footer-cell {{0}}">',c.footerclass).add(b.exec("footerCellContent")).add("</td>"),d.toString()},a.templates.footerCell.$inject=["$injector","$column"],a.templates.footerCellContent=function(b,c){var d=new a.StringBuilder;return c.footertemplate&&("function"==typeof c.footertemplate?d.add(a.applyFunc(c.footertemplate,this,[c,b])):d.add(a.supplant.call(this,c.footertemplate,c,[c,b]))),d.toString()},a.templates.footerCellContent.$inject=["$data","$column"],a.templates.footerTable=function(b){var c=new a.StringBuilder;return c.add('<table class="table" cellpadding="0" cellspacing="0">').add(b.exec("footer")).add("</table>"),c.toString()},a.templates.footerTable.$inject=["$injector"],a.templates.formGroup=function(b){var c='<div class="form-group {{editclass}}"><label class="col-sm-4 control-label">{{{label}}}</label><div class="col-sm-6">{{{input}}}</div></div>';return a.supplant.call(this,c,b)},a.templates.header=function(b,c,d){var e=new a.StringBuilder;return e.add("<thead><tr>"),b.forEach(function(a){e.add(d.setResource("$column",a).exec("headerCell"))}),e.add("</tr></thead>"),e.toString()},a.templates.header.$inject=["$columns","$config","$injector"],a.templates.headerCell=function(b,c,d){var e=new a.StringBuilder,f="";return c.sorting?f=a.escapeHTML(a.coalesce([b.sort,b.field])):a.hasValue(b.sort)&&(f=a.escapeHTML(b.sort)),e.add('<th class="header-cell '+(b.headerclass||"")+'"'),a.hasValue(f)&&e.addFormat(' data-sort="{{0}}"',f),e.add(">"),e.add(d.exec("headerCellContent")),e.add("</th>"),e.toString()},a.templates.headerCell.$inject=["$column","$config","$injector"],a.templates.headerCellContent=function(b,c){var d=this,e=new a.StringBuilder,f="";return c.sorting?f=a.escapeHTML(a.coalesce([b.sort,b.field])):a.hasValue(b.sort)&&(f=a.escapeHTML(b.sort)),b.headertemplate?"function"==typeof b.headertemplate?e.add(a.applyFunc(b.headertemplate,d,[b])):e.add(a.supplant.call(d,b.headertemplate,b,[b])):a.isNullOrEmpty(f)?e.escape(a.coalesce([b.header,b.field,""])):e.addFormat('<a href="javascript:void(0);" class="table-sort" value="sort" data-sort="{{0}}">',f).escape(a.coalesce([b.header,b.field,f])).add('<span class="glyphicon"></span>').add("</a>"),e.toString()},a.templates.headerCellContent.$inject=["$column","$config"],a.templates.input=function(b){var c={type:"boolean"==b.type?"checkbox":"number"==b.type?"number":"text",name:b.name,value:"boolean"==b.type?"true":"date"==b.type?a.format(b.value,"YYYY-MM-DD"):a.escapeHTML(b.value),checked:"boolean"==b.type&&b.value?" checked":"",dataType:/^date/.test(b.type)?' data-type="date"':"",required:b.required?" required":""},d=a.supplant.call(this,'<input type="{{type}}" name="{{name}}" value="{{value}}" class="form-control"{{{dataType}}}{{checked}}{{required}} />',c);return b.required&&(d+='<span class="required"></span>'),d},a.templates.pagerBar=function(b){var c=a.shallowCopy(b),d=new a.StringBuilder;return c.IsFirstPage=1===c.page,c.IsLastPage=c.page===c.PageCount,c.HasPages=c.PageCount>1,c.PreviousPage=1===c.page?1:c.page-1,c.NextPage=c.page===c.PageCount?c.PageCount:c.page+1,c.firstPageClass=c.IsFirstPage?"disabled":"",c.lastPageClass=c.IsLastPage?"disabled":"",c.HasPages&&d.add('<div class="btn-group">').add('<button class="ms-page-index btn btn-default {{firstPageClass}}" title="First page" value="page" data-page="1">').add('<span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span>').add("</button>").add('<button class="ms-page-index btn btn-default {{firstPageClass}}" title="Previous page" value="page" data-page="{{PreviousPage}}">').add('<span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>').add("</button>").add("</div>").add('<input type="number" name="page" value="{{page}}" class="form-control" style="width:75px;display:inline-block;vertical-align:middle" />').add('<span class="page-count"> of {{PageCount}}</span>').add('<div class="btn-group">').add('<button class="ms-page-index btn btn-default {{lastPageClass}}" title="Next page" value="page" data-page="{{NextPage}}">').add('<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>').add("</button>").add('<button class="ms-page-index btn btn-default {{lastPageClass}}" title="Last page" value="page" data-page="{{PageCount}}">').add('<span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>').add("</button>").add("</div>"),a.supplant.call(this,d.toString(),c)},a.templates.pagerBar.$inject=["$requestModel"],a.templates.sortStyle=function(b){var c={id:b.ID,sort:b.requestModel.sort,glyph:b.requestModel.desc?"\\e114":"\\e113"},d='#{{id}} a.table-sort[data-sort="{{{sort}}}"] > span.glyphicon { display:inline; } #{{id}} a.table-sort[data-sort="{{{sort}}}"] > span.glyphicon:before { content:"{{{glyph}}}"; }';return a.isNullOrEmpty(c.sort)?"":a.supplant(d,c)},a.templates.sortStyle.$inject=["$config"],a.templates.tableBody=function(b,c){var d=new a.StringBuilder;return d.addFormat('<table role="grid" class="table {{0}}" cellpadding="0" cellspacing="0">',b.tableclass),b.fixedheaders||d.add(c.exec("header")),d.add("<tbody>").add(c.exec("tableRows")).add("</tbody>"),b.hasFooter&&!b.fixedfooters&&d.add(c.exec("footer")),d.add("</table>"),d.toString()},a.templates.tableBody.$inject=["$config","$injector"],a.templates.tableRow=function(b,c,d){var e=new a.StringBuilder;return e.addFormat('<tr data-uid="{{0}}"',d),/create|update/.test(c)&&e.add(' class="').add(c).add('-mode"'),e.add(">").add(b.exec("tableRowCells")).add("</tr>"),e.toString()},a.templates.tableRow.$inject=["$injector","$mode"],a.templates.tableRowCell=function(b,c,d){var e=d||"read",f=new a.StringBuilder,g=/create|update/.test(e);return f.addFormat('<td class="body-cell {{0}}{{1}}">',[b.commands?"commands ":"",g?b.editclass:b.bodyclass]),g&&!b.readonly?f.add(c.exec("editCellContent")):f.add(c.exec("bodyCellContent")),f.add("</td>"),f.toString()},a.templates.tableRowCell.$inject=["$column","$injector","$mode"],a.templates.tableRowCells=function(b,c){var d=new a.StringBuilder;return b.forEach(function(a){c.setResource("$column",a),d.add(c.exec("tableRowCell"))}),d.toString()},a.templates.tableRowCells.$inject=["$columns","$injector"],a.templates.tableRows=function(b,c,d){var e,f=new a.StringBuilder;return null==b?"":(b.forEach(function(a){d.setResource("$dataItem",a),e=c.assign(a),f.add(d.exec("tableRow",e))}),f.toString())},a.templates.tableRows.$inject=["$data","$map","$injector"],a.templates.toolbar=function(b,c){var d=new a.StringBuilder;return b.search&&d.add('<div class="input-group gp-searchbox">').add('<input type="text" name="search" role="searchbox" class="form-control" placeholder="Search...">').add('<span class="input-group-btn">').add(c.exec("button",{btnClass:"btn-default",value:"search",glyphicon:"glyphicon-search"})).add("</span>").add("</div>"),b.create&&d.add(c.exec("button",{btnClass:"btn-default",value:"AddRow",glyphicon:"glyphicon-plus",text:"Add"})),d.toString()},a.templates.toolbar.$inject=["$config","$injector"],function(a){var b=[/&/g,/</g,/>/g,/"/g,/'/g,/`/g],c=["&amp;","&lt;","&gt;","&quot;","&apos;","&#96;"],d=Function.prototype,e=d.bind?d.bind.bind(d.call):function(a){return function(b){return function(){return a.apply(b,arguments)}}}(d.call),f={},g=e("".slice),h=0,i=e(h.toString);$.extend(a,{applyFunc:function(b,c,d,e){if("function"==typeof b)try{return void 0==d?b.call(c):(d=Array.isArray(d)?d:[d],b.apply(c,d))}catch(f){e=e||a.error,a.applyFunc(e,c,f)}},coalesce:function(b){if(a.isNullOrEmpty(b))return b;for(var c=0;c<b.length;c++)if(a.hasValue(b[c]))return b[c];return b[b.length-1]},createUID:function(){var a="gp"+g(i(Math.random(),36),2);return a in f?createUID():f[a]=a},disable:function(b,c){$(b).attr("disabled","disabled").addClass("disabled busy"),"number"==typeof c&&c>0&&setTimeout(function(){a.enable(b)},1e3*c)},enable:function(a){$(a).removeAttr("disabled").removeClass("disabled busy")},escapeHTML:function(a){return"string"!=typeof a?a:(b.forEach(function(b,d){a=a.replace(b,c[d])}),a)},format:function(b,c){var d=a.getType(b);try{if(/^(date|datestring)$/.test(d))return window.moment?(c=c||"M/D/YYYY h:mm a",moment(b).format(c)):b;if("timestamp"===d)return window.moment?(c=c||"M/D/YYYY h:mm a",b=parseInt(b.match(a.rexp.timestamp)[1]),moment(b).format(c)):b;if("number"===d)return window.numeral?(c=c||"0,0",numeral(b).format(c)):b}catch(e){a.error(e)}return b},getAttributes:function(b){for(var c,d,e={},f=$(b)[0].attributes,g=f.length-1;g>=0;g--)d=f[g],c=d.name.toLowerCase().replace("-",""),e[c]=a.rexp.trueFalse.test(d.value)||""===d.value?"true"===d.value||""===d.value:d.value;return e},getColumnByField:function(a,b){var c=a.filter(function(a){return a.field===b||a.sort===b});return c.length?c[0]:null},getCommand:function(a,b){var c=[];a.forEach(function(a){Array.isArray(a.commands)&&(c=c.concat(a.commands))});var d=c.filter(function(a){return a.value===b});if(d.length>0)return d[0]},getDefaultValue:function(a){switch(a){case"number":return 0;case"boolean":return!1;case"date":default:return null}},getFormattedValue:function(b,c,d){var e=(c.Type||"").toLowerCase(),f="function"===e?c.field(b):b[c.field];return/^(date|datestring|timestamp)$/.test(e)?a.format(f,c.format):/^(number|function)$/.test(e)&&c.format?a.format(f,c.format):""===e&&c.format&&/^(?:\d*\.)?\d+$/.test(f)?a.format(parseFloat(f),c.format):"string"===e&&d?a.escapeHTML(f):f},getObjectAtPath:function(b,c){if("string"!=typeof b)return b;var d,e=c||window;b=b.match(a.rexp.splitPath),"window"===b[0]&&(b=b.splice(1));for(var f=0;f<b.length;f++)if(d=b[f],a.rexp.indexer.test(d)?d=parseInt(/\d+/.exec(d)):a.rexp.quoted.test(d)&&(d=d.slice(1,-1)),e=e[d],void 0===e)return;return e},getTableRow:function(a,b,c){var d=a.getUid(b);if(d!=-1)return $(c).find('[data-uid="'+d+'"]')},getType:function(b){if(null===b||void 0===b)return b;var c=typeof b;return"string"===c?a.rexp.iso8601.test(b)?"datestring":a.rexp.timestamp.test(b)?"timestamp":c:"number"===c||"boolean"===c||"function"===c?c:b instanceof Date?"date":Array.isArray(b)?"array":c},hasValue:function(a){return void 0!==a&&null!==a},"implements":function(b,c){if(typeof b!=typeof c)return!1;if(!a.hasValue(b))return!0;var d=Object.getOwnPropertyNames(b),e=Object.getOwnPropertyNames(c);if(d.length<e.length){for(var f=0;f<d.length;f++)if(e.indexOf(d[f])===-1)return!1}else for(var f=0;f<e.length;f++)if(d.indexOf(e[f])===-1)return!1;return!0},isNullOrEmpty:function(b){return a.hasValue(b)===!1||void 0!=b.length&&0===b.length},resolveTypes:function(b){var c,d,e=b&&b.requestModel&&b.requestModel.Data&&b.requestModel.Data.length;b.columns.forEach(function(f){if(!a.hasValue(f.Type)&&(c=a.hasValue(f.field)?f.field:f.sort,!a.isNullOrEmpty(c))){if("function"==typeof c)return void(f.Type="function");if(b.model&&a.hasValue(b.model[c])&&"function"!==a.getType(b.model[c])&&(f.Type=a.getType(b.model[c])),!a.hasValue(f.Type)&&e)for(var g=0;g<b.requestModel.Data.length&&g<25;g++)if(d=b.requestModel.Data[g][c],null!==d){f.Type=a.getType(d);break}}})},resolveResponseModel:function(b,c){if(!a.hasValue(b))return null;var d=new a.ResponseModel;if(a["implements"](b,d))a.shallowCopy(b,d);else if(b.Data&&b.Data.length)d.DataItem=b.Data[0];else if(b.length)d.DataItem=b[0];else{if(!a["implements"](b,c))throw new Error("Could not resolve JSON response.");d.DataItem=b}return d},rexp:{splitPath:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/,iso8601:/^[012][0-9]{3}-[01][0-9]-[0123][0-9]/,timestamp:/\/Date\((\d+)\)\//,quoted:/^['"].+['"]$/,trueFalse:/true|false/i,json:/^\{.*\}$|^\[.*\]$/,copyable:/^(object|date|array|function)$/},shallowCopy:function(b,c){if(c=c||{},!a.rexp.copyable.test(a.getType(b)))return c;var d,e=Object.getOwnPropertyNames(b);Object.getOwnPropertyNames(c);return e.forEach(function(a){c.hasOwnProperty(a)&&(d=Object.getOwnPropertyDescriptor(c,a),!d.writable)||("function"==typeof b[a]?c[a]=b[a]():c[a]=b[a])}),c},supplant:function(b,c,d){var e,f,g=this,h=/^(string|number|boolean|date|datestring|timestamp)$/;return b=b.replace(/{{{([^{}]*)}}}/g,function(b,i){return f=a.getObjectAtPath(i,c),e=a.getType(f),h.test(e)?f:"function"===e?a.applyFunc(f,g,d):(f=a.getObjectAtPath(i),"function"==typeof f?a.applyFunc(f,g,d):"")}),b.replace(/{{([^{}]*)}}/g,function(b,i){return f=a.getObjectAtPath(i,c),e=a.getType(f),h.test(e)?a.escapeHTML(f):"function"===e?a.escapeHTML(a.applyFunc(f,g,d)):(f=a.getObjectAtPath(i),"function"==typeof f?a.escapeHTML(a.applyFunc(f,g,d)):"")})},triggerEvent:function(a,b){var c=new CustomEvent(b,{view:window,bubbles:!0,cancelable:!0});$(a)[0].dispatchEvent(c)},log:window.console?window.console.log.bind(window.console):function(){},error:function(a){console&&console.error&&console.error(a)}})}(gridponent),document.registerElement?(a.Gridponent=Object.create(HTMLElement.prototype),a.Gridponent.createdCallback=function(){var b=new a.Initializer(this);$(b.initialize.bind(b))},a.Gridponent.detachedCallback=function(){var a=this.querySelector(".table-container");a&&a.api&&a.api.dispose()},document.registerElement("grid-ponent",{prototype:a.Gridponent})):(a.initialize=function(b){b=$(b||document)[0];for(var c=b.querySelectorAll("grid-ponent"),d=0;d<c.length;d++)new a.Initializer(c[d]).initialize()},$(function(){a.initialize()}))}(gridponent);